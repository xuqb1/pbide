' 选项对话框
%IDC_MAINLISTBOX   = 3001
'常规
%IDC_SHOWWELCOME   = 3002
%IDC_SHOWGUILD     = 3003
%IDC_MAINWINDOWPOS = 3004
%IDC_DEFAULTPOSSIZE= 3005
%IDC_FIXPOSSIZE    = 3006
%IDC_USELASTPOSSIZE= 3007
%IDC_POSITION      = 3008
%IDC_SETCENTER     = 3009
%IDC_SETPOSITION   = 3010
%IDC_LABELX        = 3011
%IDC_SETX          = 3012
%IDC_LABELY        = 3013
%IDC_SETY          = 3014
%IDC_MAINWINDOWSIZE= 3015
%IDC_LABELWIDTH    = 3016
%IDC_SETWIDTH      = 3017
%IDC_LABELHEIGHT   = 3018
%IDC_SETHEIGHT     = 3019
%IDC_LANGUAGE      = 3020
%IDC_SETLANGUAGE   = 3021
%IDC_LABELPAGESIGN = 3022

%IDC_FILETYPE      = 3023

%IDC_LABELSOURCEFILE  = 3024
%IDC_SOURCEFILE       = 3025
%IDC_LABELINCLUDEFILE = 3026
%IDC_INCLUDEFILE      = 3027
%IDC_LABELRCFILE      = 3028
%IDC_RCFILE           = 3029
%IDC_LABELRCHEADFILE  = 3030
%IDC_RCHEADFILE       = 3031
%IDC_LABELPROJECTFILE = 3032
%IDC_PROJECTFILEEXT   = 3033
%IDC_SETFILEEXT       = 3034
%IDC_LOADRECENTFILES  = 3035
%IDC_LABELMAXFILE     = 3036
%IDC_MAXRECENTFILE    = 3037
%IDC_STARTUPFOLDER    = 3038
%IDC_DEFAULTFOLDER    = 3039
%IDC_LASTFOLDER       = 3040

%IDC_AUTOINDENT       = 3041
%IDC_KEEPUNDO         = 3042
%IDC_LABELTABSIZE     = 3043
%IDC_TABSIZE          = 3044
%IDC_AUTOSAVE1        = 3045
%IDC_AUTOSAVE2        = 3046
%IDC_AUTOSAVETIME     = 3047
%IDC_SHOWLINENUMBER   = 3048
%IDC_SHOWAUTOCOMPLETE = 3049
%IDC_KEYWORDCASE      = 3050
%IDC_NOCASECHANGE     = 3051
%IDC_UPPERCASE        = 3052
%IDC_MIXEDCASE        = 3053
%IDC_LOWERCASE        = 3054
%IDC_EDITORFONT       = 3055
%IDC_LABELFONT        = 3056
%IDC_LABELFONTSIZE    = 3057
%IDC_FONT             = 3058
%IDC_FONTSIZE         = 3059
%IDC_LABELSAMPLETEXT  = 3060
%IDC_SAMLETEXT        = 3061
%IDC_COLLAPSEEXPAND   = 3062
%IDC_COLLAPSELEVEL    = 3063
%IDC_NOCOLLAPSE       = 3064
%IDC_KEYWORDLEVEL     = 3065
%IDC_SUBFUNLEVEL      = 3066
%IDC_FOLDERICON       = 3067
%IDC_ARROWICON        = 3068
%IDC_ADDMINUSE        = 3069
%IDC_CIRCLEICON       = 3070
%IDC_SQUAREICON       = 3071

%IDC_USECOLORINEDITOR = 3072
%IDC_USECOLORINPRINTER= 3073
%IDC_LOADDEFAULTCOLOR = 3074
%IDC_ASSEMBLERBUTTON  = 3075
%IDC_COMMENTBUTTON    = 3076
%IDC_KEYWORDBUTTON    = 3077
%IDC_PBFORMSBUTTON    = 3078
%IDC_STRINGBUTTON     = 3079
%IDC_TEXTBUTTON       = 3080
%IDC_SELECTIONBUTTON  = 3081
%IDC_BREAKPOINTBUTTON = 3082
%IDC_BOOKMARKBUTTON   = 3083
%IDC_EXECPOINTBUTTON  = 3084
%IDC_RESERVED1BUTTON  = 3085
%IDC_RESERVED2BUTTON  = 3086
%IDC_LABELASM         = 3087
%IDC_LABELREM         = 3088
%IDC_LABELTCPOPEN     = 3089
%IDC_LABELPBFORMS     = 3090
%IDC_LABELLITERAL     = 3091
%IDC_LABELTEXT        = 3092
%IDC_LABELMARKED      = 3093
%IDC_LABELBREAKPOINT  = 3094
%IDC_LABELBOOKMARK    = 3095
%IDC_LABELEXECPOINT   = 3096

%IDC_SHOWGRID         = 3097
%IDC_GRIDSNAP         = 3098
%IDC_LABELGRIDSIZE    = 3099
%IDC_GRIDSIZE         = 3100
%IDC_SNAPCONTROL      = 3101
%IDC_ADJUSTHANDLE     = 3102
%IDC_SMALLHANDLE      = 3103
%IDC_MEDIUMHANDLE     = 3104
%IDC_LARGEHANDLE      = 3105

%IDC_PATH             = 3106
%IDC_LABELPBINCLUDE   = 3107
%IDC_PBINCLUDE        = 3108
%IDC_PBINCLUDEBUTTON  = 3109

%IDC_LABELRCINCLUDE   = 3110
%IDC_RCINCLUDE        = 3111
%IDC_RCINCLUDEBUTTON  = 3112

%IDC_LABELCOMPILER    = 3113
%IDC_COMPILERFILE     = 3114
%IDC_COMPILEBUTTON    = 3115

%IDC_LABELWIN32HELP   = 3116
%IDC_WIN32HELP        = 3117
%IDC_WIN32HELPBUTTON  = 3118
%IDC_COMPILEOPTION    = 3119
%IDC_BEEPCOMPLETION   = 3120
%IDC_DISPLAYRESULT    = 3121
%IDC_CREATELOGFILE    = 3122

%IDC_USECODECOLOR     = 3123
%IDC_PRINTPAGENUMBER  = 3124
%IDC_PRINTFILENAMETIME= 3125
%IDC_PAGEMARGIN       = 3126
%IDC_LABELTOPMARGIN   = 3127
%IDC_TOPMARGIN        = 3128
%IDC_LABELBOTTOMMARGIN= 3129
%IDC_BOTTOMMARGIN     = 3130
%IDC_LABELLEFTMARGIN  = 3131
%IDC_LEFTMARGIN       = 3132
%IDC_LABELRIGHTMARGIN = 3133
%IDC_RIGHTMARGIN      = 3134

%IDC_LABELHADHOTKEY    = 3135
%IDC_HOTKEYLIST        = 3136
%IDC_DELETEHOTKEY      = 3137
%IDC_LABELHOTKEYCOMMAND= 3138
%IDC_LABELHOTKEY       = 3139
%IDC_COMMANDLIST       = 3140
%IDC_HOTKEYTEXT        = 3141
%IDC_UPDATEHOTKEY      = 3142

%IDC_APPLYBUT          = 3143
%IDC_HELPBUT           = 3144
%IDC_DEFAULTBUT        = 3145

%IDC_ADDEDITLANGBUT    = 3146
%IDC_ORGISTRINGTB      = 3147
%IDC_SHOWSTRINGTB      = 3148

GLOBAL htabDlg() AS DWORD
GLOBAL lang() AS STRING
GLOBAL lastfolder AS STRING

TYPE LBDataStruct
  c1    AS STRING * 20
  c2    AS STRING * 20
  c3    AS STRING * 20
  c4    AS STRING * 20
END TYPE
GLOBAL LBData() AS LBDataStruct


FUNCTION ShowOptionWin(BYVAL hParent AS DWORD)AS LONG
  LOCAL hDlg AS DWORD, hTab AS DWORD, hCtl AS DWORD
  LOCAL tmpStr() AS STRING
  IF g_hOptionWin>0 AND isWindow(g_hOptionWin) THEN
    DIALOG SHOW STATE g_hOptionWin, %SW_SHOW
    EXIT FUNCTION
  END IF
  REDIM htabDlg(10)
  DIALOG NEW hParent, "Options", , , 409, 231, _
              %WS_POPUP OR %WS_VISIBLE OR %WS_CLIPSIBLINGS OR %WS_CAPTION OR _
              %WS_SYSMENU OR %DS_3DLOOK OR %DS_SETFONT OR %DS_MODALFRAME, _
              %WS_EX_DLGMODALFRAME OR %WS_EX_CONTROLPARENT OR %WS_EX_WINDOWEDGE TO hDlg
  g_hOptionWin=hDlg
  'Note: in PB/WIN 7.0 and later, you can also use DIALOG SET ICON hDlg, newicon$
  'For icon from resource, use something like, LoadIcon(hInst, "APP_ICON")
  DIALOG SEND hDlg, %WM_SETICON, %ICON_SMALL, LoadIcon(%NULL, BYVAL %IDI_APPLICATION)
  DIALOG SEND hDlg, %WM_SETICON, %ICON_BIG, LoadIcon(%NULL, BYVAL %IDI_APPLICATION)

  CONTROL ADD BUTTON, hDlg, %IDOK, "&OK", 190, 210, 50, 14, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_TABSTOP, _
              %WS_EX_NOPARENTNOTIFY

  CONTROL ADD BUTTON, hDlg, %IDCANCEL, "&Cancel", 245, 210, 50, 14, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_TABSTOP, _
              %WS_EX_NOPARENTNOTIFY

  CONTROL ADD BUTTON, hDlg, %IDC_APPLYBUT, "&Apply", 301, 210, 50, 14, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_DISABLED OR %WS_TABSTOP, _
              %WS_EX_NOPARENTNOTIFY

  CONTROL ADD BUTTON, hDlg, %IDC_HELPBUT, "&Help", 356, 210, 50, 14, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_TABSTOP, _
              %WS_EX_NOPARENTNOTIFY

  CONTROL ADD BUTTON, hDlg, %IDC_DEFAULTBUT, "Default", 5, 210, 50, 14, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_TABSTOP, _
              %WS_EX_NOPARENTNOTIFY
  InitCommonControls
  REDIM tmpStr(10)
  tmpStr(0)="General"
  tmpStr(1)="File"
  tmpStr(2)="Code Editor"
  tmpStr(3)="Color"
  tmpStr(4)="Window Editor"
  tmpStr(5)="Compile"
  tmpStr(6)="Print"
  tmpStr(7)="Hotkey"
  CONTROL ADD LISTBOX, hDlg,%IDC_MAINLISTBOX,tmpStr(),5,5,105,200, _
              %WS_VSCROLL OR %WS_TABSTOP, %WS_EX_CLIENTEDGE
  LISTBOX SELECT  hDlg,%IDC_MAINLISTBOX,0
  ' 这是底部的OK，CANCEL按钮上面的那条线
  CONTROL ADD LINE, hDlg,  -1, "", 115, 203, 289, 1, _
              %WS_CHILD OR %WS_VISIBLE OR %SS_ETCHEDHORZ, _
              %WS_EX_STATICEDGE OR %WS_EX_NOPARENTNOTIFY

  '从这里开始各个页面
  '第一个页面是General(常规)
  DIALOG NEW hDlg, "", 119, 5, 473, 189, _
              %WS_CHILD OR %DS_3DLOOK OR %DS_SETFONT OR %DS_CONTROL, _
              %WS_EX_CONTROLPARENT TO hTab
  htabDlg(0)=hTab  '保存句柄到数组，以用来在后面显示窗口
  DIALOG SHOW MODELESS hTab,CALL TabProc
  '这是窗口上部的那条横线
  CONTROL ADD LINE    , hTab,  -1, "", 17, 7, 269, 1
  CONTROL ADD LABEL   , hTab,  %IDC_LABELPAGESIGN, "General", 0, 3, 30, 8, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_GROUP, _
              %WS_EX_NOPARENTNOTIFY
  CONTROL ADD CHECKBOX, hTab, %IDC_SHOWWELCOME      , "Show welcome window when startup", 5,17,200,8        '启动时显示欢迎窗口
  CONTROL ADD CHECKBOX, hTab, %IDC_SHOWGUILD        , "Show guilder window after startup", 5, 31,200,8        '启动后显示向导窗口
  CONTROL ADD FRAME   , hTab, %IDC_MAINWINDOWPOS    , "Main window pos && size", 5, 45, 220,100 '主窗口位置及大小
  CONTROL ADD OPTION  , hTab, %IDC_DEFAULTPOSSIZE   , "Use default position and size", 10,59,170,8, _ '使用默认大小与位置
                                                      %WS_TABSTOP OR %BS_LEFT OR %BS_VCENTER OR %WS_GROUP
  CONTROL ADD OPTION  , hTab, %IDC_FIXPOSSIZE       , "Use fix position and size", 10,73,170,8 '使用固定大小与位置
  CONTROL ADD OPTION  , hTab, %IDC_USELASTPOSSIZE   , "Use the position and size for last",10,129,170,8 '使用上次的大小与位置
  CONTROL ADD FRAME   , hTab, %IDC_POSITION         , "Position",20,84,120,42 '位置
  CONTROL ADD OPTION  , hTab, %IDC_SETCENTER        , "Center", 25,98, 50,8, _ '居中
                                                      %WS_TABSTOP OR %BS_LEFT OR %BS_VCENTER OR %WS_GROUP
  CONTROL ADD OPTION  , hTab, %IDC_SETPOSITION      , "Special", 25,112,35,8 '指定
  CONTROL ADD LABEL   , hTab, %IDC_LABELX           , "X:",65,113,10,8 'X:
  CONTROL ADD TEXTBOX , hTab, %IDC_SETX             , "", 75,112,20,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELY           , "Y:",98,113,10,8
  CONTROL ADD TEXTBOX , hTab, %IDC_SETY             , "", 108,112,20,12
  CONTROL ADD FRAME   , hTab, %IDC_MAINWINDOWSIZE   , "Size", 145,84,60,42
  CONTROL ADD LABEL   , hTab, %IDC_LABELWIDTH       , "Width:",150,98,25,8
  CONTROL ADD TEXTBOX , hTab, %IDC_SETWIDTH         , "", 175,96,20,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELHEIGHT      , "Height:",150,112,25,8
  CONTROL ADD TEXTBOX , hTab, %IDC_SETHEIGHT        , "", 175,111,20,12
  CONTROL ADD LABEL   , hTab, %IDC_LANGUAGE         , "Please select language for this application:",5,150,220,8 '选择语言
  CONTROL ADD COMBOBOX, hTab, %IDC_SETLANGUAGE      , ,20,163,80,80
  CONTROL ADD BUTTON  , hTab, %IDC_ADDEDITLANGBUT   ,"...",102,163,16,12

  '第二个页面是File(文件)
  DIALOG NEW hDlg, "", 119, 5, 464, 184, _
              %WS_CHILD OR %DS_3DLOOK OR %DS_SETFONT OR %DS_CONTROL, _
              %WS_EX_CONTROLPARENT TO hTab
  htabDlg(1)=hTab
  DIALOG SHOW MODELESS hTab,CALL TabProc
  CONTROL ADD LINE    , hTab,  -1, "", 17, 7, 269, 1
  CONTROL ADD LABEL   , hTab, %IDC_LABELPAGESIGN    , "File", 0, 3, 17, 8, _
                                                    %WS_CHILD OR %WS_VISIBLE OR %WS_GROUP, _
                                                    %WS_EX_NOPARENTNOTIFY
  CONTROL ADD FRAME   , hTab, %IDC_FILETYPE         ,"Type",5,17,220,103
  CONTROL ADD LABEL   , hTab, %IDC_LABELSOURCEFILE  , "PB Source File:",10,31,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_SOURCEFILE       , ".bas",60,30,90,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELINCLUDEFILE , "PB Head File:",10,45,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_INCLUDEFILE      , ".inc",60,44,90,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELRCFILE      , "RC File:",10,59,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_RCFILE           , ".rc",60,58,90,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELRCHEADFILE  , "RC Head File:",10,73,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_RCHEADFILE       , ".h", 60,72,90,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELPROJECTFILE , "PB Project File:",10,87,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_PROJECTFILEEXT   , ".pbp",60,86,90,12
  CONTROL ADD CHECKBOX, hTab, %IDC_SETFILEEXT       , "Register these file extend in windows",60,103,128,12        '在系统中注册文件后缀并关联到本应用

  CONTROL ADD CHECKBOX, hTab, %IDC_LOADRECENTFILES  , "Reload previous file set at start", 10,138,110,12 '自动加载最近
  CONTROL ADD LABEL   , hTab, %IDC_LABELMAXFILE     , "Maximum Recent Files:", 10,158,90,12,%SS_RIGHT  '最近文件最大个数：
  CONTROL ADD COMBOBOX, hTab, %IDC_MAXRECENTFILE    , ,100,157,30,60
  CONTROL ADD FRAME   , hTab, %IDC_STARTUPFOLDER    , "Initial startup folder",135,130,90,43   '启动时的初始文件夹
  CONTROL ADD OPTION  , hTab, %IDC_DEFAULTFOLDER    , "Start in Default folder",140,144,80,8, _  '用默认文件夹
                                                      %WS_TABSTOP OR %BS_LEFT OR %BS_VCENTER OR %WS_GROUP
  CONTROL ADD OPTION  , hTab, %IDC_LASTFOLDER       , "Start in Last folder",140,158,80,8     '用最后使用的文件夹
  ' 第三个页面是Code Editor(代码编辑器)
  DIALOG NEW hDlg, "", 119, 5, 473, 192, _
              %WS_CHILD OR %WS_VISIBLE OR %DS_3DLOOK OR %DS_SETFONT OR _
              %DS_CONTROL, _
              %WS_EX_CONTROLPARENT TO hTab
  htabDlg(2)= hTab
  DIALOG SHOW MODELESS hTab,CALL TabProc
  CONTROL ADD LINE, hTab,  -1, "", 17, 7, 269, 1
  CONTROL ADD LABEL, hTab, %IDC_LABELPAGESIGN, "Code Editor", 0, 3, 40, 8, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_GROUP, _
              %WS_EX_NOPARENTNOTIFY
  CONTROL ADD CHECKBOX, hTab, %IDC_AUTOINDENT       , "Auto indent", 5,17,50,8          '自动缩进
  CONTROL ADD CHECKBOX, hTab, %IDC_KEEPUNDO         , "Keep Undo after save", 5,31,80,8 '保存后仍可撤销编辑
  CONTROL ADD LABEL   , hTab, %IDC_LABELTABSIZE     , "Tab size: ", 5,45,33,8           '表达Tab的空格数
  CONTROL ADD COMBOBOX, hTab, %IDC_TABSIZE          , , 35,44,30,60
  CONTROL ADD CHECKBOX, hTab, %IDC_AUTOSAVE1        , "Auto save when", 5,59,64,8      '自动备份
  CONTROL ADD LABEL   , hTab, %IDC_AUTOSAVE2        , "minutes", 87,59,40,8            '自动备份
  CONTROL ADD TEXTBOX , hTab, %IDC_AUTOSAVETIME     , "5", 70,58,15,12
  CONTROL ADD CHECKBOX, hTab, %IDC_SHOWLINENUMBER   , "Show line number", 5,73,70,8    '显示行数
  CONTROL ADD CHECKBOX, hTab, %IDC_SHOWAUTOCOMPLETE , "Show auto complete tip", 5,87,90,8 '显示自动完成提示

  CONTROL ADD FRAME   , hTab, %IDC_KEYWORDCASE      , "Keyword Case", 132,17,100,74
  CONTROL ADD OPTION  , hTab, %IDC_NOCASECHANGE     , "No Case Change", 137,31,70,8, _  '无改变
                                                      %WS_TABSTOP OR %BS_LEFT OR %BS_VCENTER OR %WS_GROUP
  CONTROL ADD OPTION  , hTab, %IDC_UPPERCASE        , "Upper Case", 137,45,50,8   '大写
  CONTROL ADD OPTION  , hTab, %IDC_MIXEDCASE        , "Mixed Case", 137,59,50,8   '首字母大写
  CONTROL ADD OPTION  , hTab, %IDC_LOWERCASE        , "Lower Case", 137,73,50,8   '小写

  CONTROL ADD FRAME   , hTab, %IDC_EDITORFONT       , "Editor Font", 0,104,120,87
  CONTROL ADD LABEL   , hTab, %IDC_LABELFONT        , "Font:", 5,115,20,8
  CONTROL ADD LABEL   , hTab, %IDC_LABELFONTSIZE    , "Size:", 80,115,20,8
  CONTROL ADD COMBOBOX, hTab, %IDC_FONT             , , 5,127,70,80, _ '%CBS_OWNERDRAWFIXED OR
                                                     %CBS_HASSTRINGS OR %CBS_DROPDOWNLIST OR _
                                                      %CBS_SORT OR %WS_TABSTOP OR %WS_VSCROLL, %WS_EX_CLIENTEDGE
  CONTROL ADD COMBOBOX, hTab, %IDC_FONTSIZE         , , 80,127,30,60
  CONTROL ADD LABEL   , hTab, %IDC_LABELSAMPLETEXT  , "Sample text", 5,145,60,8
  CONTROL ADD LABEL   , hTab, %IDC_SAMLETEXT        , "AaBbCcXxYyZz",5,157,105,23, _
                                                      %SS_CENTER OR %SS_CENTERIMAGE, %WS_EX_CLIENTEDGE
  CONTROL ADD LINE, hTab,  -1, "", 160, 99, 125, 1
  CONTROL ADD LABEL   , hTab, %IDC_COLLAPSEEXPAND   , "Collapse && Expand", 132,95,60,8    '卷展
  CONTROL ADD FRAME   , hTab, %IDC_COLLAPSELEVEL    , "Foldding Level", 132,104,100,50        '卷展级别
  CONTROL ADD OPTION  , hTab, %IDC_NOCOLLAPSE       , "No Collapse", 137,114,80,8, _          '无卷展
                                                      %WS_TABSTOP OR %BS_LEFT OR %BS_VCENTER OR %WS_GROUP
  CONTROL ADD OPTION  , hTab, %IDC_KEYWORDLEVEL     , "Keyword level", 137,126,80,8           '关键字级
  CONTROL ADD OPTION  , hTab, %IDC_SUBFUNLEVEL      , "Sub/Function level", 137,138,80,8      'sub/function级
  CONTROL ADD FRAME   , hTab, %IDC_FOLDERICON       , "Folder icon",132,155,140,35             '卷展图标
  CONTROL ADD OPTION  , hTab, %IDC_ARROWICON        , "Arrow", 137,169,30,8, _                '箭头
                                                      %WS_TABSTOP OR %BS_LEFT OR %BS_VCENTER OR %WS_GROUP
  CONTROL ADD OPTION  , hTab, %IDC_ADDMINUSE        , "+/-", 169,169,30,8                     '+/-
  CONTROL ADD OPTION  , hTab, %IDC_CIRCLEICON       , "Circle", 199,169,30,8                  '圆形
  CONTROL ADD OPTION  , hTab, %IDC_SQUAREICON       , "Square", 231,169,35,8                  '方形

  ' 第四个页面是Color(颜色)
  DIALOG NEW hDlg, "", 119, 5, 473, 192, _
              %WS_CHILD OR %WS_VISIBLE OR %DS_3DLOOK OR %DS_SETFONT OR _
              %DS_CONTROL, _
              %WS_EX_CONTROLPARENT TO hTab
  htabDlg(3)= hTab
  DIALOG SHOW MODELESS hTab,CALL TabProc
  CONTROL ADD LINE, hTab,  -1, "", 5, 7, 281, 1
  CONTROL ADD LABEL, hTab, %IDC_LABELPAGESIGN, "Color", 0, 3, 20, 8, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_GROUP, _
              %WS_EX_NOPARENTNOTIFY
  CONTROL ADD CHECKBOX, hTab, %IDC_USECOLORINEDITOR , "Use Syntax Color in Editor", 10, 13, 135, 10  '在编辑器中使用语法颜色
  CONTROL ADD CHECKBOX, hTab, %IDC_USECOLORINPRINTER, "Use Syntax Color when Printing", 10, 26, 135, 10 '打印时使用语法颜色
  CONTROL ADD BUTTON  , hTab, %IDC_LOADDEFAULTCOLOR , "Load &Defaults", 167, 13, 50, 14 '加载默认值
  CONTROL ADD BUTTON  , hTab, %IDC_ASSEMBLERBUTTON  , "Assembler", 10, 44, 50, 12       '汇编
  CONTROL ADD BUTTON  , hTab, %IDC_COMMENTBUTTON    , "Comments", 10, 60, 50, 12        '注释
  CONTROL ADD BUTTON  , hTab, %IDC_KEYWORDBUTTON    , "Keywords", 10, 76, 50, 12        '关键字
  CONTROL ADD BUTTON  , hTab, %IDC_PBFORMSBUTTON    , "PB Forms", 10, 92, 50, 12        'PB窗体
  CONTROL ADD BUTTON  , hTab, %IDC_STRINGBUTTON     , "Strings", 10, 108, 50, 12        '字符串
  CONTROL ADD BUTTON  , hTab, %IDC_TEXTBUTTON       , "Text", 10, 124, 50, 12           '文本
  CONTROL ADD BUTTON  , hTab, %IDC_SELECTIONBUTTON  , "Selection", 120, 44, 50, 12      '选中
  CONTROL ADD BUTTON  , hTab, %IDC_BREAKPOINTBUTTON , "Breakpoint", 120, 60, 50, 12     '断点
  CONTROL ADD BUTTON  , hTab, %IDC_BOOKMARKBUTTON   , "Bookmark", 120, 76, 50, 12       '书签
  CONTROL ADD BUTTON  , hTab, %IDC_EXECPOINTBUTTON  , "Exec point", 120, 92, 50, 12     '执行点
'  CONTROL ADD BUTTON  , hTab, %IDC_RESERVED1BUTTON  , "Reserved", 120, 108, 50, 12      '保留
'  CONTROL ADD BUTTON  , hTab, %IDC_RESERVED2BUTTON  , "Reserved", 120, 124, 50, 12      '保留
  CONTROL ADD LABEL   , hTab, %IDC_LABELASM         , "ASM", 62, 44, 45, 12,%SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELREM         , "REM", 62, 60, 45, 12,%SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELTCPOPEN     , "TCP OPEN", 62, 76, 45, 12, %SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELPBFORMS     , "#PBFORMS", 62, 92, 45, 12, %SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELLITERAL     , """Literal text", 62, 108, 45, 12, %SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELTEXT        , "x = 43", 62, 124, 45, 12,%SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELMARKED      , "Marked block", 172, 44, 45, 12,%SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELBREAKPOINT  , "DECR ix", 172, 60, 45, 12,%SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELBOOKMARK    , "3ECR ix", 172, 76, 45, 12, %SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  CONTROL ADD LABEL   , hTab, %IDC_LABELEXECPOINT   , "DECR ix", 172, 92, 45, 12,%SS_CENTERIMAGE OR %SS_CENTER,%WS_EX_CLIENTEDGE
  ' 第五个页面是Window Editor(窗口编辑器)
  DIALOG NEW hDlg, "", 119, 5, 473, 192, _
              %WS_CHILD OR %WS_VISIBLE OR %DS_3DLOOK OR %DS_SETFONT OR _
              %DS_CONTROL, _
              %WS_EX_CONTROLPARENT TO hTab
  htabDlg(4)= hTab
  DIALOG SHOW MODELESS hTab,CALL TabProc
  CONTROL ADD LINE, hTab,  -1, "", 5, 7, 281, 1
  CONTROL ADD LABEL, hTab, %IDC_LABELPAGESIGN, "Window Editor", 0, 3, 50, 8, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_GROUP, _
              %WS_EX_NOPARENTNOTIFY
  CONTROL ADD CHECKBOX, hTab, %IDC_SHOWGRID         , "Show grid", 10, 13, 50, 10
  CONTROL ADD CHECKBOX, hTab, %IDC_GRIDSNAP         , "Snap to grid", 10, 27, 60, 10
  CONTROL ADD LABEL   , hTab, %IDC_LABELGRIDSIZE    , "Grid size:", 12, 41, 38, 10,%SS_RIGHT
  CONTROL ADD COMBOBOX, hTab, %IDC_GRIDSIZE         , , 50, 40, 40, 60
  CONTROL ADD CHECKBOX, hTab, %IDC_SNAPCONTROL      , "Snap between controls", 10, 55, 80, 10
  CONTROL ADD FRAME   , hTab, %IDC_ADJUSTHANDLE     , "Adjust handle size", 0, 69, 100, 60
  CONTROL ADD OPTION  , hTab, %IDC_SMALLHANDLE      , "Small", 10,83,30,10
  CONTROL ADD OPTION  , hTab, %IDC_MEDIUMHANDLE     , "Medium", 10,97,40,10
  CONTROL ADD OPTION  , hTab, %IDC_LARGEHANDLE      , "Large", 10,111,30,10

  ' 第六个页面是Compiler(编译器)
  DIALOG NEW hDlg, "", 119, 5, 473, 192, _
              %WS_CHILD OR %WS_VISIBLE OR %DS_3DLOOK OR %DS_SETFONT OR _
              %DS_CONTROL, _
              %WS_EX_CONTROLPARENT TO hTab
  htabDlg(5)= hTab
  DIALOG SHOW MODELESS hTab,CALL TabProc
  CONTROL ADD LINE, hTab,  -1, "", 5, 7, 281, 1
  CONTROL ADD LABEL, hTab, %IDC_LABELPAGESIGN, "Compiler", 0, 3, 30, 8, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_GROUP, _
              %WS_EX_NOPARENTNOTIFY
  CONTROL ADD FRAME   , hTab, %IDC_PATH             , "Paths", 0, 13, 265, 80
  CONTROL ADD LABEL   , hTab, %IDC_LABELPBINCLUDE   , "PB Include:", 10,27,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_PBINCLUDE        , "", 60,26,180,12
  CONTROL ADD BUTTON  , hTab, %IDC_PBINCLUDEBUTTON  , "...", 240,26,15,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELRCINCLUDE   , "RC Include:", 10,41,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_RCINCLUDE        , "", 60,40,180,12
  CONTROL ADD BUTTON  , hTab, %IDC_RCINCLUDEBUTTON  , "...", 240,40,15,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELCOMPILER    , "Compiler File:",10,56,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_COMPILERFILE     , "", 60,55,180,12
  CONTROL ADD BUTTON  , hTab, %IDC_COMPILEBUTTON    , "...", 240,55,15,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELWIN32HELP   , "Win32.hlp File:",10,70,50,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_WIN32HELP        , "", 60,69,180,12
  CONTROL ADD BUTTON  , hTab, %IDC_WIN32HELPBUTTON  , "...", 240,69,15,12
  CONTROL ADD FRAME   , hTab, %IDC_COMPILEOPTION    , "Compiler Options",0,97,100,60
  CONTROL ADD CHECKBOX, hTab, %IDC_BEEPCOMPLETION   , "Beep on compiletion",10,111,80,10
  CONTROL ADD CHECKBOX, hTab, %IDC_DISPLAYRESULT    , "Display Results",10,125,60,10
  CONTROL ADD CHECKBOX, hTab, %IDC_CREATELOGFILE    , "Create Log file",10,139,60,10

  ' 第七个页面是Printer(打印)
  DIALOG NEW hDlg, "", 119, 5, 473, 192, _
              %WS_CHILD OR %WS_VISIBLE OR %DS_3DLOOK OR %DS_SETFONT OR _
              %DS_CONTROL, _
              %WS_EX_CONTROLPARENT TO hTab
  htabDlg(6)= hTab
  DIALOG SHOW MODELESS hTab,CALL TabProc
  CONTROL ADD LINE, hTab,  -1, "", 5, 7, 281, 1
  CONTROL ADD LABEL, hTab, %IDC_LABELPAGESIGN, "Printer", 0, 3, 30, 8, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_GROUP, _
              %WS_EX_NOPARENTNOTIFY
  CONTROL ADD CHECKBOX, hTab, %IDC_USECODECOLOR     , "Use the color for code in editor when print", 10, 13, 200, 10
  CONTROL ADD CHECKBOX, hTab, %IDC_PRINTPAGENUMBER  , "Print page number on footer with the format [#/#]",10,27,200,10
  CONTROL ADD CHECKBOX, hTab, %IDC_PRINTFILENAMETIME, "Print filename, time and date of the file on header",10,41,200,10
  CONTROL ADD FRAME   , hTab, %IDC_PAGEMARGIN       , "Margin",0,55,83,75
  CONTROL ADD LABEL   , hTab, %IDC_LABELTOPMARGIN   , "Top:", 10,69,25,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_TOPMARGIN        , "10", 40,68,20,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELBOTTOMMARGIN, "Bottom:", 10,83,25,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_BOTTOMMARGIN     , "10", 40,82,20,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELLEFTMARGIN  , "Left:", 10,97,25,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_LEFTMARGIN       , "10", 40,96,20,12
  CONTROL ADD LABEL   , hTab, %IDC_LABELRIGHTMARGIN , "Right:", 10,111,25,8,%SS_RIGHT
  CONTROL ADD TEXTBOX , hTab, %IDC_RIGHTMARGIN      , "10", 40,110,20,12
  CONTROL ADD LABEL   , hTab, -1                    , "mm", 62,69,12,8
  CONTROL ADD LABEL   , hTab, -1                    , "mm", 62,83,12,8
  CONTROL ADD LABEL   , hTab, -1                    , "mm", 62,97,12,8
  CONTROL ADD LABEL   , hTab, -1                    , "mm", 62,111,12,8

  ' 第八个页面是Hotkey(热键)
  DIALOG NEW hDlg, "", 119, 5, 473, 192, _
              %WS_CHILD OR %WS_VISIBLE OR %DS_3DLOOK OR %DS_SETFONT OR _
              %DS_CONTROL, _
              %WS_EX_CONTROLPARENT  TO hTab
  DIALOG SHOW MODELESS hTab,CALL TabProc
  htabDlg(7)= hTab
  CONTROL ADD LINE, hTab,  -1, "", 5, 7, 281, 1
  CONTROL ADD LABEL, hTab, %IDC_LABELPAGESIGN, "Hotkey", 0, 3, 30, 8, _
              %WS_CHILD OR %WS_VISIBLE OR %WS_GROUP, _
              %WS_EX_NOPARENTNOTIFY
  CONTROL ADD LABEL   , hTab, %IDC_LABELHADHOTKEY     , "Defined Hotkey:", 5,13,80,8
  CONTROL ADD LISTBOX , hTab, %IDC_HOTKEYLIST         , , 10, 25, 150, 130,%WS_CHILD OR _
                              %WS_VISIBLE  OR %LBS_HASSTRINGS OR _ '%LBS_NOTIFY OR _
                              %WS_VSCROLL OR %WS_HSCROLL OR %LBS_USETABSTOPS OR %LBS_STANDARD, %WS_EX_CLIENTEDGE
  DIM TabStops(1) AS LONG
  ARRAY ASSIGN TabStops()= -60,40
  CONTROL SEND hTab, %IDC_HOTKEYLIST, %LB_SETTABSTOPS, 2, VARPTR(TabStops(0))
  CONTROL ADD BUTTON  , hTab, %IDC_DELETEHOTKEY       , "Delete", 170,125, 40,14
  CONTROL ADD LABEL   , hTab, %IDC_LABELHOTKEYCOMMAND , "Command:", 5, 145, 40, 8
  CONTROL ADD LABEL   , hTab, %IDC_LABELHOTKEY        , "Hotkey:", 85, 145, 30, 8
  CONTROL ADD COMBOBOX, hTab, %IDC_COMMANDLIST        , , 10, 156, 70, 80
  CONTROL ADD TEXTBOX , hTab, %IDC_HOTKEYTEXT         , "", 95, 156, 65, 12
  CONTROL ADD BUTTON  , hTab, %IDC_UPDATEHOTKEY       , "Update", 170,155, 40,14

  DIALOG SHOW MODELESS hDlg, CALL OptionWinProc

END FUNCTION
CALLBACK FUNCTION TabProc
  LOCAL tmpStr AS STRING
  LOCAL tmpLng AS LONG
  SELECT CASE AS LONG CB.MSG
    CASE %WM_COMMAND
      SELECT CASE AS LONG CB.CTL
        CASE %IDC_ADDEDITLANGBUT
          SetLangDlg CB.HNDL
        CASE %IDC_SHOWWELCOME, %IDC_SHOWGUILD, %IDC_DEFAULTPOSSIZE, %IDC_FIXPOSSIZE, %IDC_USELASTPOSSIZE _
              ,%IDC_SETX, %IDC_SETY, %IDC_SETWIDTH, %IDC_SETHEIGHT, _   'Checkbox Option Textbox等被单击后，即改变应用与默认按钮状态
              %IDC_SOURCEFILE,%IDC_INCLUDEFILE,%IDC_RCFILE,%IDC_RCHEADFILE,%IDC_PROJECTFILEEXT, _
              %IDC_SETFILEEXT,%IDC_LOADRECENTFILES,%IDC_MAXRECENTFILE,%IDC_DEFAULTFOLDER,%IDC_LASTFOLDER, _
              %IDC_AUTOINDENT,%IDC_KEEPUNDO,%IDC_TABSIZE,%IDC_AUTOSAVE1,%IDC_AUTOSAVETIME,%IDC_SHOWLINENUMBER, _
              %IDC_SHOWAUTOCOMPLETE,%IDC_NOCASECHANGE,%IDC_UPPERCASE,%IDC_MIXEDCASE,%IDC_LOWERCASE,%IDC_FONT, _
              %IDC_FONTSIZE, %IDC_NOCOLLAPSE, %IDC_KEYWORDLEVEL,%IDC_SUBFUNLEVEL,%IDC_ARROWICON,%IDC_ADDMINUSE, _
              %IDC_CIRCLEICON,%IDC_SQUAREICON,%IDC_USECOLORINEDITOR,%IDC_USECOLORINPRINTER,%IDC_ASSEMBLERBUTTON, _
              %IDC_COMMENTBUTTON,%IDC_KEYWORDBUTTON,%IDC_PBFORMSBUTTON,%IDC_STRINGBUTTON,%IDC_TEXTBUTTON,%IDC_SELECTIONBUTTON, _
              %IDC_BREAKPOINTBUTTON,%IDC_EXECPOINTBUTTON,%IDC_SHOWGRID,%IDC_GRIDSNAP,%IDC_GRIDSIZE,%IDC_SNAPCONTROL, _
              %IDC_SMALLHANDLE,%IDC_MEDIUMHANDLE,%IDC_LARGEHANDLE, %IDC_PBINCLUDE,%IDC_PBINCLUDEBUTTON, %IDC_RCINCLUDE, _
              %IDC_RCINCLUDEBUTTON,%IDC_COMPILERFILE,%IDC_COMPILEBUTTON,%IDC_WIN32HELP,%IDC_WIN32HELPBUTTON,%IDC_BEEPCOMPLETION, _
              %IDC_DISPLAYRESULT,%IDC_CREATELOGFILE, %IDC_USECODECOLOR,%IDC_PRINTFILENAMETIME,%IDC_TOPMARGIN,%IDC_BOTTOMMARGIN, _
              %IDC_LEFTMARGIN,%IDC_RIGHTMARGIN
           IF CBCTLMSG = %BN_CLICKED THEN
             CONTROL ENABLE g_hOptionWin,%IDC_APPLYBUT
             CONTROL ENABLE g_hOptionWin,%IDC_DEFAULTBUT
           END IF
         CASE %IDC_DELETEHOTKEY     '删除快捷键按钮
           IF CBCTLMSG = %BN_CLICKED THEN
             CONTROL ENABLE g_hOptionWin,%IDC_APPLYBUT
             CONTROL ENABLE g_hOptionWin,%IDC_DEFAULTBUT
           END IF
         CASE %IDC_UPDATEHOTKEY     '更新快捷键按钮
           IF CBCTLMSG = %BN_CLICKED THEN
             CONTROL ENABLE g_hOptionWin,%IDC_APPLYBUT
             CONTROL ENABLE g_hOptionWin,%IDC_DEFAULTBUT
           END IF
         CASE %IDC_LOADDEFAULTCOLOR '加载默认颜色按钮
           IF CBCTLMSG = %BN_CLICKED THEN
            LoadDefaultColor CB.HNDL
            CONTROL ENABLE g_hOptionWin,%IDC_APPLYBUT
            CONTROL ENABLE g_hOptionWin,%IDC_DEFAULTBUT
           END IF
         CASE %IDC_SETLANGUAGE     '语言选择组合框
           IF CB.CTLMSG = %CBN_SELENDOK THEN '%CBN_CLOSEUP then'%CBN_SELCHANGE THEN
             COMBOBOX GET TEXT CB.HNDL,%IDC_SETLANGUAGE TO tmpStr
             SetLanguage tmpStr
             CONTROL ENABLE g_hOptionWin,%IDC_APPLYBUT
             CONTROL ENABLE g_hOptionWin,%IDC_DEFAULTBUT
           END IF

        CASE %IDC_HOTKEYLIST
          IF CBCTLMSG = %LBN_SELCHANGE THEN
             'MSGBOX "%IDC_HOTKEYLIST"
             LISTBOX GET TEXT CB.HNDL, %IDC_HOTKEYLIST TO tmpStr
             LISTBOX GET SELECT CB.HNDL, %IDC_HOTKEYLIST TO tmpLng
             COMBOBOX SELECT CB.HNDL, %IDC_COMMANDLIST, tmpLng
             'msgbox tmpStr & $crlf & str$(parsecount(tmpStr,$tab)) & $crlf & PARSE$(tmpStr,$TAB,2)
             CONTROL SET TEXT CB.HNDL,%IDC_HOTKEYTEXT, PARSE$(tmpStr,$TAB,3)
           END IF

      END SELECT


  END SELECT

END FUNCTION
'增加或修改字符串语言
FUNCTION SetLangDlg(BYVAL hParent AS DWORD)AS LONG
  LOCAL hDlg AS DWORD
  DIALOG NEW hParent,GetLang("Add Or Modify String for Current Lang"),,,200,80 TO hDlg '增加或修改字符串
  CONTROL ADD LABEL,  hDlg, -1, GetLang("Orgi String") & ":",5,10,50,12,%SS_RIGHT
  CONTROL ADD TEXTBOX,hDlg,%IDC_ORGISTRINGTB,"",57,9,138,12
  CONTROL ADD LABEL,  hDlg, -1, GetLang("Show As") & ":",5,24,50,12,%SS_RIGHT
  CONTROL ADD TEXTBOX,hDlg,%IDC_SHOWSTRINGTB,"",57,23,138,12
  CONTROL ADD BUTTON, hDlg,%IDOK,GetLang("OK"),70,50,50,20
  CONTROL ADD BUTTON, hDlg,%IDCANCEL,GetLang("Cancel"),130,50,50,20
  DIALOG SHOW MODAL  hDlg CALL SetLangDlgProc
END FUNCTION
CALLBACK FUNCTION SetLangDlgProc() AS LONG
  LOCAL tmpStr AS STRING
  LOCAL tmpStr1 AS STRING
  LOCAL tmpStr2 AS STRING
  SELECT CASE LONG CB.MSG
    CASE %WM_COMMAND
      SELECT CASE AS LONG CB.CTL
        CASE %IDOK
          CONTROL GET TEXT CB.HNDL,%IDC_ORGISTRINGTB TO tmpStr1
          CONTROL GET TEXT CB.HNDL,%IDC_SHOWSTRINGTB TO tmpStr2
          tmpStr1=TRIM$(tmpStr1)
          tmpStr2=TRIM$(tmpStr2)
          IF tmpStr1="" OR tmpStr2="" THEN
            MSGBOX GetLang("OrgiString or ShowString is null"),,GetLang("Message")
            EXIT FUNCTION
          END IF
          IF WriteLang(tmpStr1,tmpStr2)=0 THEN
            MSGBOX GetLang("failed for setting show string"),,GetLang("Message")
            EXIT FUNCTION
          END IF
          DIALOG END CB.HNDL,0
        CASE %IDCANCEL
          DIALOG END CB.HNDL,0
      END SELECT
  END SELECT
END FUNCTION
'初始化选项
SUB InitOption(BYVAL hDlg AS DWORD)
  LOCAL tmpStr AS STRING
  LOCAL tmpStr1 AS STRING
  LOCAL tmpArr() AS STRING
  LOCAL i AS INTEGER
  LOCAL hFont AS LONG
  LOCAL hWnd AS LONG
  IF hDlg<=0 THEN
    EXIT SUB
  END IF
  '常规
  tmpStr=ReadConfig("showflashwindow")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(0), %IDC_SHOWWELCOME, VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("showguiderwindow")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(0), %IDC_SHOWGUILD, VAL(tmpStr)
  END IF
  '常规--主窗口位置与大小
  tmpStr=ReadConfig("mainwindowposopt")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(0), %IDC_DEFAULTPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
      CASE "1"
        CONTROL SET OPTION htabDlg(0), %IDC_FIXPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
      CASE "2"
        CONTROL SET OPTION htabDlg(0), %IDC_USELASTPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
      CASE "3"
        CONTROL SET OPTION htabDlg(0), %IDC_FIXPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
        CONTROL SET OPTION htabDlg(0), %IDC_SETCENTER, %IDC_SETCENTER, %IDC_SETPOSITION
      CASE "4"
        CONTROL SET OPTION htabDlg(0), %IDC_FIXPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
        CONTROL SET OPTION htabDlg(0), %IDC_SETPOSITION, %IDC_SETCENTER, %IDC_SETPOSITION
    END SELECT
  END IF
  tmpStr=ReadConfig("mainwindowpos")
  IF tmpStr<>"" AND INSTR(tmpStr,",")>0 THEN
    CONTROL SET TEXT htabDlg(0), %IDC_SETX, MID$(tmpStr,1,INSTR(tmpStr,",")-1)
    CONTROL SET TEXT htabDlg(0), %IDC_SETY, MID$(tmpStr,INSTR(tmpStr,",")+1)
  END IF
  tmpStr=ReadConfig("mainwindowsize")
  IF tmpStr<>"" AND INSTR(tmpStr,",")>0 THEN
    CONTROL SET TEXT htabDlg(0), %IDC_SETWIDTH, MID$(tmpStr,1,INSTR(tmpStr,",")-1)
    CONTROL SET TEXT htabDlg(0), %IDC_SETHEIGHT, MID$(tmpStr,INSTR(tmpStr,",")+1)
  END IF
  '常规--语言
  language=ReadConfig("language")'全局语言变量，用来保存当前所选择的语言，从配置中读取语言配置，即所选择的语言
  IF language="" THEN            '如果为空，则设置为English
    language="English"
  END IF
  tmpStr=ReadDataset("language") '从数据集中取出定义的所有语言
  IF tmpStr<>"" THEN
    REDIM lang(1 TO PARSECOUNT(tmpStr,"|"))  '对定义的所有语言进行分解并赋给全局lang()变量
    PARSE tmpStr,lang(),"|"
    COMBOBOX RESET htabDlg(0),%IDC_SETLANGUAGE
    FOR i=1 TO UBOUND(lang())              '循环读取lang()中的值
      tmpStr=ReadLang(lang(i),language)
      IF tmpStr<>"" THEN                   '如果不为空，则
        COMBOBOX INSERT htabDlg(0),%IDC_SETLANGUAGE, i,tmpStr '插入到界面上的语言列表中
        IF lang(i)=language THEN                              '如果当前选择的语言与语言列表中的某一项相等，则界面上设置为选择状态
          COMBOBOX SELECT htabDlg(0),%IDC_SETLANGUAGE,i
        END IF
      END IF
      'COMBOBOX set user htabDlg(0),%IDC_SETLANGUAGE, i,i
    NEXT i
  END IF
  '文件
  tmpStr=ReadConfig("sourcefiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_SOURCEFILE,tmpStr
  END IF
  tmpStr=ReadConfig("includefiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_INCLUDEFILE,tmpStr
  END IF
  tmpStr=ReadConfig("resourcefiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_RCFILE,tmpStr
  END IF
  tmpStr=ReadConfig("rcheadfiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_RCHEADFILE,tmpStr
  END IF
  tmpStr=ReadConfig("projectfiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_PROJECTFILEEXT,tmpStr
  END IF
  tmpStr=ReadConfig("registryfiletype")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(1),%IDC_SETFILEEXT,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("autoreloadfile")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(1),%IDC_LOADRECENTFILES,VAL(tmpStr)
  END IF
  tmpStr=ReadDataset("recentfilenumber")
  IF tmpStr<>"" THEN
    REDIM tmpArr(1 TO PARSECOUNT(tmpStr,"|"))
    PARSE tmpStr,tmpArr(),"|"
    tmpStr=ReadConfig("recentfilenumber")
    FOR i=1 TO UBOUND(tmpArr())
      COMBOBOX INSERT htabDlg(1),%IDC_MAXRECENTFILE, i, tmpArr(i)
      IF tmpStr<>"" AND tmpStr=tmpArr(i) THEN
        COMBOBOX SELECT htabDlg(1),%IDC_MAXRECENTFILE,i
      END IF
    NEXT i
  END IF
  tmpStr=ReadConfig("startfolder")
  IF tmpStr<>"" THEN
    IF tmpStr="0" THEN
      CONTROL SET OPTION htabDlg(1),%IDC_DEFAULTFOLDER,%IDC_DEFAULTFOLDER,%IDC_LASTFOLDER
    ELSE
      CONTROL SET OPTION htabDlg(1),%IDC_LASTFOLDER,%IDC_DEFAULTFOLDER,%IDC_LASTFOLDER
    END IF
  END IF
  '代码编辑
  tmpStr=ReadConfig("autoindent")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_AUTOINDENT,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("undoaftersave")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_KEEPUNDO,VAL(tmpStr)
  END IF
  tmpStr=ReadDataset("tabsize")
  IF tmpStr<>"" THEN
    REDIM tmpArr(1 TO PARSECOUNT(tmpStr,"|"))
    PARSE tmpStr,tmpArr(),"|"
    tmpStr=ReadConfig("spacepertab")
    FOR i=1 TO UBOUND(tmpArr())
      COMBOBOX INSERT htabDlg(2),%IDC_TABSIZE,i,tmpArr(i)
      IF tmpStr<>"" AND tmpStr=tmpArr(i) THEN
        COMBOBOX SELECT htabDlg(2),%IDC_TABSIZE,i
      END IF
    NEXT i
    IF tmpStr<>"" THEN
      COMBOBOX GET TEXT htabDlg(2),%IDC_TABSIZE TO tmpStr1
      IF tmpStr<>tmpStr1 THEN
        CONTROL SET TEXT htabDlg(2),%IDC_TABSIZE,tmpStr
      END IF
    END IF
  END IF
  tmpStr=ReadConfig("autosave")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_AUTOSAVE1, VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("autosaveminute")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(2),%IDC_AUTOSAVETIME,tmpStr
    'CONTROL SEND htabDlg(2),%IDC_AUTOSAVETIME, %CB_SELECTSTRING, -1, STRPTR(tmpStr)
  END IF
  tmpStr=ReadConfig("showlinenumber")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_SHOWLINENUMBER, VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("autocompletetip")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_SHOWAUTOCOMPLETE,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("keywordcase")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(2),%IDC_NOCASECHANGE,%IDC_NOCASECHANGE,%IDC_LOWERCASE
      CASE "1"
        CONTROL SET OPTION htabDlg(2),%IDC_UPPERCASE,%IDC_NOCASECHANGE,%IDC_LOWERCASE
      CASE "2"
        CONTROL SET OPTION htabDlg(2),%IDC_MIXEDCASE,%IDC_NOCASECHANGE,%IDC_LOWERCASE
      CASE "3"
        CONTROL SET OPTION htabDlg(2),%IDC_LOWERCASE,%IDC_NOCASECHANGE,%IDC_LOWERCASE
    END SELECT
  END IF
  FillFontCombo GetDlgItem(htabDlg(2), %IDC_FONT)
  tmpStr=ReadConfig("font")
  IF tmpStr<>"" THEN
    CONTROL SEND htabDlg(2),%IDC_FONT, %CB_SELECTSTRING, -1, STRPTR(tmpStr)
  END IF
  FOR i=1 TO 29
    COMBOBOX INSERT htabDlg(2),%IDC_FONTSIZE,i,FORMAT$(i+1)
    tmpStr=ReadConfig("fontsize")
    IF tmpStr<>"" AND tmpStr=FORMAT$(i+1) THEN
      COMBOBOX SELECT htabDlg(2),%IDC_FONTSIZE,i
    END IF
  NEXT i
  tmpStr=ReadConfig("font")
  tmpStr1=ReadConfig("fontsize")
  IF tmpStr<>"" AND tmpStr1<>"" THEN
    FONT NEW tmpStr,VAL(tmpStr1),0,0,0,0 TO hFont
    CONTROL SET FONT htabDlg(2),%IDC_SAMLETEXT,hFont
  END IF
  tmpStr=ReadConfig("folderlevel")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(2),%IDC_NOCOLLAPSE,%IDC_NOCOLLAPSE,%IDC_SUBFUNLEVEL
      CASE "1"
        CONTROL SET OPTION htabDlg(2),%IDC_KEYWORDLEVEL,%IDC_NOCOLLAPSE,%IDC_SUBFUNLEVEL
      CASE "2"
        CONTROL SET OPTION htabDlg(2),%IDC_SUBFUNLEVEL,%IDC_NOCOLLAPSE,%IDC_SUBFUNLEVEL
    END SELECT
  END IF
  tmpStr=ReadConfig("foldericon")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(2),%IDC_ADDMINUSE,%IDC_ADDMINUSE,%IDC_SQUAREICON
      CASE "1"
        CONTROL SET OPTION htabDlg(2),%IDC_CIRCLEICON,%IDC_ADDMINUSE,%IDC_SQUAREICON
      CASE "2"
        CONTROL SET OPTION htabDlg(2),%IDC_SQUAREICON,%IDC_ADDMINUSE,%IDC_SQUAREICON
    END SELECT
  END IF
  '颜色
  tmpStr=ReadConfig("usecolorineditor")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(3),%IDC_USECOLORINEDITOR,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("usecolorwhenprint")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(3),%IDC_USECOLORINPRINTER,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("assembleforecolor")
  tmpStr1=ReadConfig("assemblebackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELASM,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELASM,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELASM,2,GetColor(tmpStr1)
  tmpStr=ReadConfig("commentforecolor")
  tmpStr1=ReadConfig("commentbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELREM,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELREM,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELREM,2,GetColor(tmpStr1)
'  tmpStr=ReadConfig("assembleforecolor")
'  tmpStr1=ReadConfig("assemblebackcolor")
'  CONTROL SET COLOR htabDlg(3),%IDC_LABELASM,GetColor(tmpStr),GetColor(tmpStr1)
'  CONTROL SET USER htabDlg(3),%IDC_LABELASM,1,GetColor(tmpStr)
'  CONTROL SET USER htabDlg(3),%IDC_LABELASM,2,GetColor(tmpStr)
  tmpStr=ReadConfig("keywordforecolor")
  tmpStr1=ReadConfig("keywordbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELTCPOPEN,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELTCPOPEN,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELTCPOPEN,2,GetColor(tmpStr1)
  tmpStr=ReadConfig("pbformforecolor")
  tmpStr1=ReadConfig("pbformbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELPBFORMS,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELPBFORMS,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELPBFORMS,2,GetColor(tmpStr1)
  tmpStr=ReadConfig("stringforecolor")
  tmpStr1=ReadConfig("stringbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELLITERAL,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELLITERAL,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELLITERAL,2,GetColor(tmpStr1)
  tmpStr=ReadConfig("textforecolor")
  tmpStr1=ReadConfig("textbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELTEXT,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELTEXT,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELTEXT,2,GetColor(tmpStr1)
  tmpStr=ReadConfig("selectedforecolor")
  tmpStr1=ReadConfig("selectedbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELMARKED,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELMARKED,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELMARKED,2,GetColor(tmpStr1)
  tmpStr=ReadConfig("breakpointforecolor")
  tmpStr1=ReadConfig("breakpointbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELBREAKPOINT,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELBREAKPOINT,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELBREAKPOINT,2,GetColor(tmpStr1)
  tmpStr=ReadConfig("bookmarkforecolor")
  tmpStr1=ReadConfig("bookmarkbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELBOOKMARK,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELBOOKMARK,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELBOOKMARK,2,GetColor(tmpStr1)
  tmpStr=ReadConfig("execpointforecolor")
  tmpStr1=ReadConfig("execpointbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELEXECPOINT,GetColor(tmpStr),GetColor(tmpStr1)
  CONTROL SET USER htabDlg(3),%IDC_LABELEXECPOINT,1,GetColor(tmpStr)
  CONTROL SET USER htabDlg(3),%IDC_LABELEXECPOINT,2,GetColor(tmpStr1)
  '窗口编辑
  tmpStr=ReadConfig("showgrid")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(4),%IDC_SHOWGRID,VAL(tmpStr)
  END IF
  tmpstr=ReadConfig("snaptogrid")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(4),%IDC_GRIDSNAP,VAL(tmpStr)
  END IF
  tmpStr=ReadDataset("gridsize")
  IF tmpStr<>"" THEN
    REDIM tmpArr(1 TO PARSECOUNT(tmpStr,"|"))
    PARSE tmpStr,tmpArr(),"|"
    tmpStr=ReadConfig("gridsize")
    FOR i=1 TO UBOUND(tmpArr())
      COMBOBOX INSERT htabDlg(4),%IDC_GRIDSIZE,i,tmpArr(i)
      IF tmpStr<>"" AND tmpStr=tmpArr(i) THEN
        COMBOBOX SELECT htabDlg(4),%IDC_GRIDSIZE,i
      END IF
    NEXT i
  END IF
  tmpStr=ReadConfig("snapbetweencontrol")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(4),%IDC_SNAPCONTROL,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("adjusthandlesize")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(4),%IDC_SMALLHANDLE,%IDC_SMALLHANDLE,%IDC_LARGEHANDLE
      CASE "1"
        CONTROL SET OPTION htabDlg(4),%IDC_MEDIUMHANDLE,%IDC_SMALLHANDLE,%IDC_LARGEHANDLE
      CASE "2"
        CONTROL SET OPTION htabDlg(4),%IDC_LARGEHANDLE,%IDC_SMALLHANDLE,%IDC_LARGEHANDLE
    END SELECT
  END IF
  '编译
  tmpStr=ReadConfig("includefilepath")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(5),%IDC_PBINCLUDE,tmpStr
  END IF
  tmpStr=ReadConfig("resourcefilepath")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(5),%IDC_RCINCLUDE,tmpStr
  END IF
  tmpStr=ReadConfig("compilefilepath")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(5),%IDC_COMPILERFILE,tmpStr
  END IF
  tmpStr=ReadConfig("win32helpfilepath")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(5),%IDC_WIN32HELP,tmpStr
  END IF
  tmpStr=ReadConfig("beepwhencomplete")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(5),%IDC_BEEPCOMPLETION,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("showcompileresult")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(5),%IDC_DISPLAYRESULT,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("createcompilelog")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(5),%IDC_CREATELOGFILE,VAL(tmpStr)
  END IF
  '打印
  tmpStr=ReadConfig("usecolorwhenprint")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(6),%IDC_USECODECOLOR,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("pagenumberonfooter")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(6),%IDC_PRINTPAGENUMBER,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("filenamedatatimeonheader")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(6),%IDC_PRINTFILENAMETIME,VAL(tmpStr)
  END IF
  tmpStr=ReadConfig("topmargin")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(6),%IDC_TOPMARGIN,tmpStr
  END IF
  tmpStr=ReadConfig("bottommargin")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(6),%IDC_BOTTOMMARGIN,tmpStr
  END IF
  tmpStr=ReadConfig("leftmargin")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(6),%IDC_LEFTMARGIN,tmpStr
  END IF
  tmpStr=ReadConfig("rightmargin")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(6),%IDC_RIGHTMARGIN,tmpStr
  END IF
  '热键
  'CONTROL HANDLE htabDlg(7),%IDC_HOTKEYLIST TO hWnd
'  IF hWnd>0 THEN
'
'  END IF
  tmpStr=ReadConfig("Commands")
  IF tmpStr<>"" THEN
    REDIM tmpArr(1 TO PARSECOUNT(tmpStr,","))
    PARSE tmpStr,tmpArr(),","
    FOR i=1 TO UBOUND(tmpArr())
      tmpStr=ReadConfig(tmpArr(i))
      IF tmpStr<>"" THEN
        tmpStr1=$TAB & tmpArr(i) & $TAB & tmpStr
        LISTBOX INSERT htabDlg(7),%IDC_HOTKEYLIST,i,tmpStr1
      END IF
      COMBOBOX INSERT htabDlg(7),%IDC_COMMANDLIST,i,tmpArr(i)
    NEXT i
  END IF
END SUB
'从以字符串形式表达的三段式值转成颜色整体值
FUNCTION GetColor(BYVAL rgbColor AS STRING)AS LONG
  LOCAL ColorArr() AS STRING
  IF rgbColor="" OR PARSECOUNT(rgbColor,",")<>3 THEN
    FUNCTION=-1 'rgb(0,0,0)
    EXIT FUNCTION
  END IF
  REDIM ColorArr(1 TO PARSECOUNT(rgbColor,","))
  PARSE rgbColor,ColorArr(),","
  FUNCTION=RGB(VAL(ColorArr(1)),VAL(ColorArr(2)),VAL(ColorArr(3)))
END FUNCTION
'用系统字体填充组合框
SUB FillFontCombo(BYVAL hWnd AS DWORD)
  LOCAL hDC AS DWORD
  SendMessage hWnd, %CB_RESETCONTENT, 0, 0
  hDC = GetDC(%HWND_DESKTOP)
  EnumFontFamilies hDC, BYVAL %NULL, CODEPTR(EnumFontName), BYVAL VARPTR(hWnd)
  ReleaseDC %HWND_DESKTOP, hDC
END SUB
'对要填充到组合框中的字体进行过滤
FUNCTION EnumFontName(lf AS LOGFONT, tm AS TEXTMETRIC, BYVAL FontType AS LONG, hWnd AS DWORD) AS LONG
  IF (FontType AND %TrueType_FontType) AND (LEFT$(lf.lfFaceName,1)<>"@") THEN  'TT fonts not start with "@"
    SendMessage hWnd, %CB_ADDSTRING, 0, VARPTR(lf.lfFaceName)
  END IF
  FUNCTION = 1
END FUNCTION
'保存选项到数据库中
SUB SaveOption(BYVAL hDlg AS DWORD)
  LOCAL hResult AS LONG
  LOCAL tmpLng AS LONG
  LOCAL tmpLng1 AS LONG
  LOCAL tmpStr AS STRING
  LOCAL tmpStr1 AS STRING
  LOCAL tmpRC   AS RECT
  LOCAL i AS INTEGER
  IF hDlg<=0 THEN
    EXIT SUB
  END IF
  '常规
  CONTROL GET CHECK htabDlg(0),%IDC_SHOWWELCOME TO hResult
  WriteConfig "showflashwindow",FORMAT$(hResult)
  CONTROL GET CHECK htabDlg(0),%IDC_SHOWGUILD TO hResult
  WriteConfig "showguiderwindow",FORMAT$(hResult)
  CONTROL GET CHECK htabDlg(0),%IDC_DEFAULTPOSSIZE TO tmpLng
  IF tmpLng=1 THEN
    hResult=0
  END IF
  CONTROL GET CHECK htabDlg(0),%IDC_FIXPOSSIZE TO tmpLng
  IF tmpLng=1 THEN
    hResult=1
  END IF
  CONTROL GET CHECK htabDlg(0),%IDC_USELASTPOSSIZE TO tmpLng
  IF tmpLng=1 THEN
    hResult=2
  END IF
  IF hResult=1 THEN
    CONTROL GET CHECK htabDlg(0),%IDC_SETCENTER TO tmpLng1
    IF tmpLng1=1 THEN
      hResult=3
    END IF
    CONTROL GET CHECK htabDlg(0),%IDC_SETPOSITION TO tmpLng1
    IF tmpLng1=1 THEN
      hResult=4
    END IF
  END IF
  WriteConfig "mainwindowposopt",FORMAT$(hResult)

  GetWindowRect g_hWndMain, tmpRC
  CONTROL GET TEXT htabDlg(0),%IDC_SETX TO tmpStr
  CONTROL GET TEXT htabDlg(0),%IDC_SETY TO tmpStr1
  IF tmpStr="" THEN
    tmpStr=FORMAT$(tmpRC.nLeft)
  END IF
  IF tmpStr1="" THEN
    tmpStr1=FORMAT$(tmpRC.nTop)
  END IF
  WriteConfig "mainwindowpos",tmpStr & "," & tmpStr1
  CONTROL GET TEXT htabDlg(0),%IDC_SETWIDTH TO tmpStr
  CONTROL GET TEXT htabDlg(0),%IDC_SETHEIGHT TO tmpStr1
  IF tmpStr="" THEN
    tmpStr=FORMAT$(tmpRC.nRight-tmpRC.nLeft)
  END IF
  IF tmpStr1="" THEN
    tmpStr1=FORMAT$(tmpRC.nBottom-tmpRC.nTop)
  END IF
  WriteConfig "mainwindowsize",tmpStr & "," & tmpStr1
  'GetWindowRect g_hWndMain, tmpRC
  WriteConfig "mainwindowlastpos",FORMAT$(tmpRC.nLeft) & "," & FORMAT$(tmpRC.nTop)
  WriteConfig "mainwindowlastsize",FORMAT$(tmpRC.nRight-tmpRC.nLeft) & "," & FORMAT$(tmpRC.nBottom-tmpRC.nTop)
  WriteConfig "language",language
  '是否要执行界面语言切换？
  '文件
  CONTROL GET TEXT htabDlg(1),%IDC_SOURCEFILE TO tmpStr
  WriteConfig "sourcefiletype",tmpStr
  CONTROL GET TEXT htabDlg(1),%IDC_INCLUDEFILE TO tmpStr
  WriteConfig "includefiletype",tmpStr
  CONTROL GET TEXT htabDlg(1),%IDC_RCFILE TO tmpStr
  WriteConfig "resourcefiletype",tmpStr
  CONTROL GET TEXT htabDlg(1),%IDC_RCHEADFILE TO tmpStr
  WriteConfig "rcheadfiletype",tmpStr
  CONTROL GET TEXT htabDlg(1),%IDC_PROJECTFILEEXT TO tmpStr
  WriteConfig "projectfiletype",tmpStr
  CONTROL GET CHECK htabDlg(1),%IDC_SETFILEEXT TO tmpLng
  RegistryFileType tmpLng
  WriteConfig "registryfiletype",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(1),%IDC_LOADRECENTFILES TO tmpLng
  WriteConfig "autoreloadfile",FORMAT$(tmpLng)
  CONTROL GET TEXT htabDlg(1),%IDC_MAXRECENTFILE TO tmpStr
  WriteConfig "recentfilenumber",tmpStr
  CONTROL GET CHECK htabDlg(1),%IDC_DEFAULTFOLDER TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=0
  END IF
  CONTROL GET CHECK htabDlg(1),%IDC_LASTFOLDER TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=1
  END IF
  WriteConfig "startfolder",FORMAT$(tmpLng)
  WriteConfig "lastfolder",lastfolder
  '代码编辑
  CONTROL GET CHECK htabDlg(2),%IDC_AUTOINDENT TO tmpLng
  WriteConfig "autoindent",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(2),%IDC_KEEPUNDO TO tmpLng
  WriteConfig "undoaftersave", FORMAT$(tmpLng)
  CONTROL GET TEXT htabDlg(2),%IDC_TABSIZE TO tmpStr
  WriteConfig "spacepertab",tmpStr
  CONTROL GET CHECK htabDlg(2),%IDC_AUTOSAVE1 TO tmpLng
  WriteConfig "autosave",FORMAT$(tmpLng)
  CONTROL GET TEXT htabDlg(2),%IDC_AUTOSAVETIME TO tmpStr
  WriteConfig "autosaveminute",tmpStr
  CONTROL GET CHECK htabDlg(2),%IDC_SHOWLINENUMBER TO tmpLng
  WriteConfig "autosaveminute",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(2),%IDC_SHOWAUTOCOMPLETE TO tmpLng
  WriteConfig "autocompletetip",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(2), %IDC_NOCASECHANGE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=0
  END IF
  CONTROL GET CHECK htabDlg(2), %IDC_UPPERCASE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=1
  END IF
  CONTROL GET CHECK htabDlg(2),%IDC_MIXEDCASE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=2
  END IF
  CONTROL GET CHECK htabDlg(2),%IDC_LOWERCASE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=3
  END IF
  WriteConfig "keywordcase",FORMAT$(tmpLng1)
  CONTROL GET TEXT htabDlg(2),%IDC_FONT TO tmpStr
  WriteConfig "font",tmpStr
  CONTROL GET TEXT htabDlg(2),%IDC_FONTSIZE TO tmpStr
  WriteConfig "fontsize",tmpStr
  CONTROL GET CHECK htabDlg(2),%IDC_NOCOLLAPSE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=0
  END IF
  CONTROL GET CHECK htabDlg(2),%IDC_KEYWORDLEVEL TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=1
  END IF
  CONTROL GET CHECK htabDlg(2),%IDC_SUBFUNLEVEL TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=2
  END IF
  WriteConfig "folderlevel",FORMAT$(tmpLng1)
  CONTROL GET CHECK htabDlg(2),%IDC_ARROWICON TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=0
  END IF
  CONTROL GET CHECK htabDlg(2),%IDC_ADDMINUSE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=1
  END IF
  CONTROL GET CHECK htabDlg(2),%IDC_CIRCLEICON TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=2
  END IF
  CONTROL GET CHECK htabDlg(2),%IDC_SQUAREICON TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=3
  END IF
  WriteConfig "foldericon",FORMAT$(tmpLng1)
  '语法颜色
  CONTROL GET CHECK htabDlg(3),%IDC_USECOLORINEDITOR TO tmpLng
  WriteConfig "usecolorineditor",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(3),%IDC_USECOLORINPRINTER TO tmpLng
  WriteConfig "usecolorwhenprint",FORMAT$(tmpLng)
  CONTROL GET USER htabDlg(3),%IDC_LABELASM,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "assembleforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELASM,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "assemblebackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELREM,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "commentforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELREM,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "commentbackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELTCPOPEN,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "keywordforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELTCPOPEN,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "keywordbackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELPBFORMS,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "pbformforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELPBFORMS,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "pbformbackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELLITERAL,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "stringforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELLITERAL,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "stringbackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELTEXT,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "textforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELTEXT,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "textbackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELMARKED,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "selectedforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELMARKED,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "selectedbackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELBREAKPOINT,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "breakpointforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELBREAKPOINT,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "breakpointbackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELBOOKMARK,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "bookmarkforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELBOOKMARK,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "bookmarkbackcolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELEXECPOINT,1 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "execpointforecolor",tmpStr
  CONTROL GET USER htabDlg(3),%IDC_LABELEXECPOINT,2 TO tmpLng
  tmpStr=FORMAT$(red(tmpLng)) & "," & FORMAT$(green(tmpLng)) & "," & FORMAT$(blue(tmpLng))
  WriteConfig "execpointbackcolor",tmpStr
  '窗口编辑
  CONTROL GET CHECK htabDlg(4),%IDC_SHOWGRID TO tmpLng
  WriteConfig "showgrid",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(4),%IDC_GRIDSNAP TO tmpLng
  WriteConfig "snaptogrid",FORMAT$(tmpLng)
  CONTROL GET TEXT htabDlg(4),%IDC_GRIDSIZE TO tmpStr
  WriteConfig "gridsize",tmpStr
  CONTROL GET CHECK htabDlg(4), %IDC_SNAPCONTROL TO tmpLng
  WriteConfig "snapbetweencontrol",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(4), %IDC_SMALLHANDLE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=0
  END IF
  CONTROL GET CHECK htabDlg(4), %IDC_MEDIUMHANDLE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=1
  END IF
  CONTROL GET CHECK htabDlg(4), %IDC_LARGEHANDLE TO tmpLng
  IF tmpLng=1 THEN
    tmpLng1=2
  END IF
  WriteConfig "adjusthandlesize",FORMAT$(tmpLng)
  '编译
  CONTROL GET TEXT htabDlg(5), %IDC_PBINCLUDE TO tmpStr
  WriteConfig "includefilepath",tmpStr
  CONTROL GET TEXT htabDlg(5), %IDC_RCINCLUDE TO tmpStr
  WriteConfig "resourcefilepath",tmpStr
  CONTROL GET TEXT htabDlg(5), %IDC_COMPILERFILE TO tmpStr
  WriteConfig "compilefilepath",tmpStr
  CONTROL GET TEXT htabDlg(5), %IDC_WIN32HELP TO tmpStr
  WriteConfig "win32helpfilepath",tmpStr
  CONTROL GET CHECK htabDlg(5), %IDC_BEEPCOMPLETION TO tmpLng
  WriteConfig "beepwhencomplete",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(5), %IDC_DISPLAYRESULT TO tmpLng
  WriteConfig "showcompileresult",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(5), %IDC_CREATELOGFILE TO tmpLng
  WriteConfig "createcompilelog",FORMAT$(tmpLng)
  '打印
  CONTROL GET CHECK htabDlg(6), %IDC_PRINTPAGENUMBER TO tmpLng
  WriteConfig "pagenumberonfooter",FORMAT$(tmpLng)
  CONTROL GET CHECK htabDlg(6), %IDC_PRINTFILENAMETIME TO tmpLng
  WriteConfig "filenamedatatimeonheader", FORMAT$(tmpLng)
  CONTROL GET TEXT htabDlg(6), %IDC_TOPMARGIN TO tmpStr
  WriteConfig "topmargin",tmpStr
  CONTROL GET TEXT htabDlg(6), %IDC_BOTTOMMARGIN TO tmpStr
  WriteConfig "bottommargin",tmpStr
  CONTROL GET TEXT htabDlg(6), %IDC_LEFTMARGIN TO tmpStr
  WriteConfig "leftmargin",tmpStr
  CONTROL GET TEXT htabDlg(6), %IDC_RIGHTMARGIN TO tmpStr
  WriteConfig "rightmargin",tmpStr
  '热键
  LISTBOX GET COUNT htabDlg(7), %IDC_HOTKEYLIST TO tmpLng
  FOR i=1 TO tmpLng
    LISTBOX GET TEXT htabDlg(7), %IDC_HOTKEYLIST TO tmpStr
    IF PARSECOUNT(tmpStr,$TAB)<>3 THEN
      ITERATE FOR
    END IF
    WriteConfig PARSE$(tmpStr,2),PARSE$(tmpStr,3)
  NEXT i

END SUB
'从整体颜色值中取出红色部分
FUNCTION red(BYVAL rgbColor AS DWORD)AS LONG
  FUNCTION=LO(BYTE,rgbColor)
END FUNCTION
'从整体颜色值中取出蓝色部分
FUNCTION blue(BYVAL rgbColor AS DWORD)AS LONG
  SHIFT RIGHT rgbColor,16
  FUNCTION=rgbColor 'lo(byte,rgbColor)
END FUNCTION
'从整体颜色值中取出绿色部分
FUNCTION green(BYVAL rgbColor AS DWORD)AS LONG
  SHIFT RIGHT rgbColor,8
  FUNCTION=LO(BYTE,rgbColor)
END FUNCTION
'加载默认选项
SUB LoadDefaultOption(BYVAL hDlg AS DWORD)
  LOCAL tmpStr AS STRING
  LOCAL tmpStr1 AS STRING
  LOCAL tmpArr() AS STRING
  LOCAL i AS INTEGER
  LOCAL hFont AS LONG
  LOCAL hWnd AS LONG
  IF hDlg<=0 THEN
    EXIT SUB
  END IF
  '常规
  tmpStr=ReadDefaultConfig("showflashwindow")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(0), %IDC_SHOWWELCOME, VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("showguiderwindow")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(0), %IDC_SHOWGUILD, VAL(tmpStr)
  END IF
  '常规--主窗口位置与大小
  tmpStr=ReadDefaultConfig("mainwindowposopt")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(0), %IDC_DEFAULTPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
      CASE "1"
        CONTROL SET OPTION htabDlg(0), %IDC_FIXPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
      CASE "2"
        CONTROL SET OPTION htabDlg(0), %IDC_USELASTPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
      CASE "3"
        CONTROL SET OPTION htabDlg(0), %IDC_FIXPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
        CONTROL SET OPTION htabDlg(0), %IDC_SETCENTER, %IDC_SETCENTER, %IDC_SETPOSITION
      CASE "4"
        CONTROL SET OPTION htabDlg(0), %IDC_FIXPOSSIZE, %IDC_DEFAULTPOSSIZE,%IDC_USELASTPOSSIZE
        CONTROL SET OPTION htabDlg(0), %IDC_SETPOSITION, %IDC_SETCENTER, %IDC_SETPOSITION
    END SELECT
  END IF
  tmpStr=ReadDefaultConfig("mainwindowpos")
  IF tmpStr<>"" AND INSTR(tmpStr,",")>0 THEN
    CONTROL SET TEXT htabDlg(0), %IDC_SETX, MID$(tmpStr,1,INSTR(tmpStr,",")-1)
    CONTROL SET TEXT htabDlg(0), %IDC_SETY, MID$(tmpStr,INSTR(tmpStr,",")+1)
  END IF
  tmpStr=ReadDefaultConfig("mainwindowsize")
  IF tmpStr<>"" AND INSTR(tmpStr,",")>0 THEN
    CONTROL SET TEXT htabDlg(0), %IDC_SETWIDTH, MID$(tmpStr,1,INSTR(tmpStr,",")-1)
    CONTROL SET TEXT htabDlg(0), %IDC_SETHEIGHT, MID$(tmpStr,INSTR(tmpStr,",")+1)
  END IF
  '常规--语言
  language=ReadDefaultConfig("language")'全局语言变量，用来保存当前所选择的语言，从配置中读取语言配置，即所选择的语言
  IF language="" THEN            '如果为空，则设置为English
    language="Chinese"
  END IF
  tmpStr=ReadDataset("language") '从数据集中取出定义的所有语言
  IF tmpStr<>"" THEN
    REDIM lang(1 TO PARSECOUNT(tmpStr,"|"))  '对定义的所有语言进行分解并赋给全局lang()变量
    PARSE tmpStr,lang(),"|"
    FOR i=1 TO UBOUND(lang())              '循环读取lang()中的值
      tmpStr=ReadLang(lang(i),language)
      IF tmpStr<>"" THEN                   '如果不为空，则
        COMBOBOX INSERT htabDlg(0),%IDC_SETLANGUAGE, i,tmpStr '插入到界面上的语言列表中
        IF lang(i)=language THEN                              '如果当前选择的语言与语言列表中的某一项相等，则界面上设置为选择状态
          COMBOBOX SELECT htabDlg(0),%IDC_SETLANGUAGE,i
        END IF
      END IF
      'COMBOBOX set user htabDlg(0),%IDC_SETLANGUAGE, i,i
    NEXT i
  END IF
  '文件
  tmpStr=ReadDefaultConfig("sourcefiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_SOURCEFILE,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("includefiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_INCLUDEFILE,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("resourcefiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_RCFILE,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("rcheadfiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_RCHEADFILE,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("projectfiletype")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(1),%IDC_PROJECTFILEEXT,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("registryfiletype")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(1),%IDC_SETFILEEXT,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("autoreloadfile")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(1),%IDC_LOADRECENTFILES,VAL(tmpStr)
  END IF
  tmpStr=ReadDataset("recentfilenumber")
  IF tmpStr<>"" THEN
    REDIM tmpArr(1 TO PARSECOUNT(tmpStr,"|"))
    PARSE tmpStr,tmpArr(),"|"
    tmpStr=ReadDefaultConfig("recentfilenumber")
    FOR i=1 TO UBOUND(tmpArr())
      COMBOBOX INSERT htabDlg(1),%IDC_MAXRECENTFILE, i, tmpArr(i)
      IF tmpStr<>"" AND tmpStr=tmpArr(i) THEN
        COMBOBOX SELECT htabDlg(1),%IDC_MAXRECENTFILE,i
      END IF
    NEXT i
  END IF
  tmpStr=ReadDefaultConfig("startfolder")
  IF tmpStr<>"" THEN
    IF tmpStr="0" THEN
      CONTROL SET OPTION htabDlg(1),%IDC_DEFAULTFOLDER,%IDC_DEFAULTFOLDER,%IDC_LASTFOLDER
    ELSE
      CONTROL SET OPTION htabDlg(1),%IDC_LASTFOLDER,%IDC_DEFAULTFOLDER,%IDC_LASTFOLDER
    END IF
  END IF
  '代码编辑
  tmpStr=ReadDefaultConfig("autoindent")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_AUTOINDENT,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("undoaftersave")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_KEEPUNDO,VAL(tmpStr)
  END IF
  tmpStr=ReadDataset("tabsize")
  IF tmpStr<>"" THEN
    REDIM tmpArr(1 TO PARSECOUNT(tmpStr,"|"))
    PARSE tmpStr,tmpArr(),"|"
    tmpStr=ReadDefaultConfig("spacepertab")
    FOR i=1 TO UBOUND(tmpArr())
      COMBOBOX INSERT htabDlg(2),%IDC_TABSIZE,i,tmpArr(i)
      IF tmpStr<>"" AND tmpStr=tmpArr(i) THEN
        COMBOBOX SELECT htabDlg(2),%IDC_TABSIZE,i
      END IF
    NEXT i
    IF tmpStr<>"" THEN
      COMBOBOX GET TEXT htabDlg(2),%IDC_TABSIZE TO tmpStr1
      IF tmpStr<>tmpStr1 THEN
        CONTROL SET TEXT htabDlg(2),%IDC_TABSIZE,tmpStr
      END IF
    END IF
  END IF
  tmpStr=ReadDefaultConfig("autosave")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_AUTOSAVE1, VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("autosaveminute")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(2),%IDC_AUTOSAVETIME,tmpStr
    'CONTROL SEND htabDlg(2),%IDC_AUTOSAVETIME, %CB_SELECTSTRING, -1, STRPTR(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("showlinenumber")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_SHOWLINENUMBER, VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("autocompletetip")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(2),%IDC_SHOWAUTOCOMPLETE,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("keywordcase")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(2),%IDC_NOCASECHANGE,%IDC_NOCASECHANGE,%IDC_LOWERCASE
      CASE "1"
        CONTROL SET OPTION htabDlg(2),%IDC_UPPERCASE,%IDC_NOCASECHANGE,%IDC_LOWERCASE
      CASE "2"
        CONTROL SET OPTION htabDlg(2),%IDC_MIXEDCASE,%IDC_NOCASECHANGE,%IDC_LOWERCASE
      CASE "3"
        CONTROL SET OPTION htabDlg(2),%IDC_LOWERCASE,%IDC_NOCASECHANGE,%IDC_LOWERCASE
    END SELECT
  END IF
  FillFontCombo GetDlgItem(htabDlg(2), %IDC_FONT)
  tmpStr=ReadDefaultConfig("font")
  IF tmpStr<>"" THEN
    CONTROL SEND htabDlg(2),%IDC_FONT, %CB_SELECTSTRING, -1, STRPTR(tmpStr)
  END IF
  FOR i=1 TO 29
    COMBOBOX INSERT htabDlg(2),%IDC_FONTSIZE,i,FORMAT$(i+1)
    tmpStr=ReadDefaultConfig("fontsize")
    IF tmpStr<>"" AND tmpStr=FORMAT$(i+1) THEN
      COMBOBOX SELECT htabDlg(2),%IDC_FONTSIZE,i
    END IF
  NEXT i
  tmpStr=ReadDefaultConfig("font")
  tmpStr1=ReadDefaultConfig("fontsize")
  IF tmpStr<>"" AND tmpStr1<>"" THEN
    FONT NEW tmpStr,VAL(tmpStr1),0,0,0,0 TO hFont
    CONTROL SET FONT htabDlg(2),%IDC_SAMLETEXT,hFont
  END IF
  tmpStr=ReadDefaultConfig("folderlevel")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(2),%IDC_NOCOLLAPSE,%IDC_NOCOLLAPSE,%IDC_SUBFUNLEVEL
      CASE "1"
        CONTROL SET OPTION htabDlg(2),%IDC_KEYWORDLEVEL,%IDC_NOCOLLAPSE,%IDC_SUBFUNLEVEL
      CASE "2"
        CONTROL SET OPTION htabDlg(2),%IDC_SUBFUNLEVEL,%IDC_NOCOLLAPSE,%IDC_SUBFUNLEVEL
    END SELECT
  END IF
  tmpStr=ReadDefaultConfig("foldericon")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(2),%IDC_ADDMINUSE,%IDC_ADDMINUSE,%IDC_SQUAREICON
      CASE "1"
        CONTROL SET OPTION htabDlg(2),%IDC_CIRCLEICON,%IDC_ADDMINUSE,%IDC_SQUAREICON
      CASE "2"
        CONTROL SET OPTION htabDlg(2),%IDC_SQUAREICON,%IDC_ADDMINUSE,%IDC_SQUAREICON
    END SELECT
  END IF
  '颜色
  tmpStr=ReadDefaultConfig("usecolorineditor")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(3),%IDC_USECOLORINEDITOR,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("usecolorwhenprint")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(3),%IDC_USECOLORINPRINTER,VAL(tmpStr)
  END IF
  LoadDefaultColor hDlg
  '窗口编辑
  tmpStr=ReadDefaultConfig("showgrid")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(4),%IDC_SHOWGRID,VAL(tmpStr)
  END IF
  tmpstr=ReadDefaultConfig("snaptogrid")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(4),%IDC_GRIDSNAP,VAL(tmpStr)
  END IF
  tmpStr=ReadDataset("gridsize")
  IF tmpStr<>"" THEN
    REDIM tmpArr(1 TO PARSECOUNT(tmpStr,"|"))
    PARSE tmpStr,tmpArr(),"|"
    tmpStr=ReadDefaultConfig("gridsize")
    FOR i=1 TO UBOUND(tmpArr())
      COMBOBOX INSERT htabDlg(4),%IDC_GRIDSIZE,i,tmpArr(i)
      IF tmpStr<>"" AND tmpStr=tmpArr(i) THEN
        COMBOBOX SELECT htabDlg(4),%IDC_GRIDSIZE,i
      END IF
    NEXT i
  END IF
  tmpStr=ReadDefaultConfig("snapbetweencontrol")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(4),%IDC_SNAPCONTROL,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("adjusthandlesize")
  IF tmpStr<>"" THEN
    SELECT CASE tmpStr
      CASE "0"
        CONTROL SET OPTION htabDlg(4),%IDC_SMALLHANDLE,%IDC_SMALLHANDLE,%IDC_LARGEHANDLE
      CASE "1"
        CONTROL SET OPTION htabDlg(4),%IDC_MEDIUMHANDLE,%IDC_SMALLHANDLE,%IDC_LARGEHANDLE
      CASE "2"
        CONTROL SET OPTION htabDlg(4),%IDC_LARGEHANDLE,%IDC_SMALLHANDLE,%IDC_LARGEHANDLE
    END SELECT
  END IF
  '编译
  tmpStr=ReadDefaultConfig("includefilepath")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(5),%IDC_PBINCLUDE,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("resourcefilepath")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(5),%IDC_RCINCLUDE,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("compilefilepath")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(5),%IDC_COMPILERFILE,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("win32helpfilepath")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(5),%IDC_WIN32HELP,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("beepwhencomplete")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(5),%IDC_BEEPCOMPLETION,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("showcompileresult")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(5),%IDC_DISPLAYRESULT,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("createcompilelog")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(5),%IDC_CREATELOGFILE,VAL(tmpStr)
  END IF
  '打印
  tmpStr=ReadDefaultConfig("usecolorwhenprint")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(6),%IDC_USECODECOLOR,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("pagenumberonfooter")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(6),%IDC_PRINTPAGENUMBER,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("filenamedatatimeonheader")
  IF tmpStr<>"" THEN
    CONTROL SET CHECK htabDlg(6),%IDC_PRINTFILENAMETIME,VAL(tmpStr)
  END IF
  tmpStr=ReadDefaultConfig("topmargin")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(6),%IDC_TOPMARGIN,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("bottommargin")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(6),%IDC_BOTTOMMARGIN,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("leftmargin")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(6),%IDC_LEFTMARGIN,tmpStr
  END IF
  tmpStr=ReadDefaultConfig("rightmargin")
  IF tmpStr<>"" THEN
    CONTROL SET TEXT htabDlg(6),%IDC_RIGHTMARGIN,tmpStr
  END IF
  '热键
  'CONTROL HANDLE htabDlg(7),%IDC_HOTKEYLIST TO hWnd
'  IF hWnd>0 THEN
'
'  END IF
  tmpStr=ReadDefaultConfig("Commands")
  IF tmpStr<>"" THEN
    REDIM tmpArr(1 TO PARSECOUNT(tmpStr,","))
    PARSE tmpStr,tmpArr(),","
    FOR i=1 TO UBOUND(tmpArr())
      tmpStr=ReadDefaultConfig(tmpArr(i))
      IF tmpStr<>"" THEN
        tmpStr1=$TAB & tmpArr(i) & $TAB & tmpStr
        LISTBOX INSERT htabDlg(7),%IDC_HOTKEYLIST,i,tmpStr1
      END IF
      COMBOBOX INSERT htabDlg(7),%IDC_COMMANDLIST,i,tmpArr(i)
    NEXT i
  END IF
END SUB
'いいいいいいいいいいいいいいいいいいいいいいいいいいいいいいいいいいい
' Main Dialog procedure
'----------------------------------------------------------------------
CALLBACK FUNCTION OptionWinProc() AS LONG
  LOCAL ln1 AS LONG
  LOCAL i AS INTEGER
  LOCAL hPen AS LONG
  LOCAL szTxt AS ASCIIZ * 300
  LOCAL lpDis AS DRAWITEMSTRUCT PTR
  LOCAL tmpStr AS STRING
  LOCAL tmpLng AS LONG
  STATIC NoUpdate AS LONG
  LOCAL hList AS DWORD
  SELECT CASE CBMSG
     CASE %WM_INITDIALOG
        'First message - a good place to initiate things, declare variables,
        'create controls and read/set settings from a file, etc.
        '-------------------------------------------------------------------
        LISTBOX SELECT CB.HNDL, %IDC_MAINLISTBOX ,1
        '初始化各个选项控件的状态
        SetOptionLang
        InitOption CB.HNDL

'     case %WM_CTLCOLORLISTBOX
'       if NoUpdate then exit function
'       NoUpdate = %TRUE
'       hList = %IDC_HOTKEYLIST
'
'       NoUpdate=%FALSE
     CASE %WM_COMMAND
       'Messages from controls and menu items are handled here.
       '-------------------------------------------------------
       SELECT CASE CBCTL

         CASE %IDCANCEL            '取消按钮
           IF CBCTLMSG = %BN_CLICKED THEN
             'DIALOG END CBHNDL, 0
             DIALOG SHOW STATE CB.HNDL, %SW_HIDE
           END IF
         CASE %IDC_DEFAULTBUT      '加载默认设置按钮
           IF CBCTLMSG=%BN_CLICKED THEN
             LoadDefaultOption CB.HNDL
             'CONTROL GET TEXT CB.HNDL,%IDC_SETLANGUAGE TO tmpStr
             'SetLanguage tmpStr
             CONTROL ENABLE CB.HNDL, %IDC_APPLYBUT
             CONTROL DISABLE CB.HNDL,%IDC_DEFAULTBUT
           END IF
         CASE %IDOK                '确定按钮
           IF CBCTLMSG=%BN_CLICKED THEN
             '关闭窗口
             DIALOG SHOW STATE CB.HNDL, %SW_HIDE
             '保存设置
             SaveOption CB.HNDL
             'DIALOG END CBHNDL,0
           END IF
         CASE %IDC_APPLYBUT        '应用按钮
           IF CBCTLMSG=%BN_CLICKED THEN
             '使应用按钮无效
             CONTROL DISABLE CB.HNDL,%IDC_APPLYBUT
             '保存设置
             SaveOption CB.HNDL
           END IF
         CASE %IDC_HELPBUT         '帮助按钮
         CASE %IDC_DEFAULTBUT      '加载默认设置按钮
           IF CBCTLMSG=%BN_CLICKED THEN
             '加载默认设置
             LoadDefaultOption CB.HNDL
             '使应用按钮无效
             CONTROL DISABLE CB.HNDL,%IDC_DEFAULTBUT
           END IF
       END SELECT

     CASE %WM_CTLCOLORBTN, %WM_CTLCOLOREDIT, %WM_CTLCOLORLISTBOX, %WM_CTLCOLORSTATIC
        ' CBWPARAM is handle of control's display context (hDC)
        ' CBLPARAM is handle of control
        '------------------------------------------------------
        IF CB.LPARAM = GetDlgItem(CB.HNDL,%IDC_MAINLISTBOX) THEN
          LISTBOX GET SELECT CB.HNDL, %IDC_MAINLISTBOX TO ln1
          FOR i=1 TO UBOUND(htabDlg())
            IF htabDlg(i-1)>0 AND IsWindow(htabDlg(i-1)) THEN
              IF i=ln1 THEN
                ShowWindow htabDlg(ln1-1),%SW_SHOW
              ELSE
                ShowWindow htabDlg(i-1),%SW_HIDE
              END IF
            END IF
          NEXT i
        END IF
     CASE %WM_DESTROY
        'is sent when program ends - a good place to delete created
        'objects and store settings in file for next run, etc.
        '-------------------------------------------------------------

     CASE %WM_SIZE
        IF CBWPARAM <> %SIZE_MINIMIZED THEN
           ' LOWRD(CBLPARAM) = width of dialog's client area
           ' HIWRD(CBLPARAM) = height of dialog's client area
           ' Example that resizes a control to dialog's client area:
           '-------------------------------------------------------
           'LOCAL pt AS POINTAPI, rc AS RECT
           'GetWindowRect GetDlgItem(CBHNDL, CtlId), rc   'get control's position on screen
           'pt.x = rc.nLeft : pt.y = rc.nTop              'need left and top pos
           'ScreenToClient CBHNDL, pt                     'convert coordinates to client area
           'MoveWindow GetDlgItem(CBHNDL, CtlId), pt.x, pt.y, _
           '           LOWRD(CBLPARAM) - pt.x, HIWRD(CBLPARAM) - pt.y, %TRUE
        END IF
    CASE %WM_DRAWITEM
        IF CBWPARAM = %IDC_HOTKEYLIST THEN    ' CBWPARAM holds control's ID
            lpdis = CBLPARAM            ' CBLPARAM points to a DRAWITEMSTRUCT structure
            IF @lpdis.itemID = &HFFFFFFFF THEN EXIT FUNCTION 'if list is empty

            SELECT CASE @lpdis.itemAction
                CASE %ODA_DRAWENTIRE, %ODA_SELECT
                    IF (@lpdis.itemState AND %ODS_SELECTED) = 0 THEN                ' Not selected
                        FillRect @lpdis.hDC, @lpdis.rcItem, GetSysColorBrush(%COLOR_WINDOW) ' cls
                        SetBkColor @lpdis.hDC, GetSysColor(%COLOR_WINDOW)           ' Text background
                        SetTextColor @lpdis.hDC, GetSysColor(%COLOR_WINDOWTEXT)     ' Text color
                    ELSE                                                            ' Is Selected
                        FillRect @lpdis.hDC, @lpdis.rcItem, GetSysColorBrush(%COLOR_HIGHLIGHT) ' cls
                        SetBkColor @lpdis.hDC, GetSysColor(%COLOR_HIGHLIGHT)        ' Text background
                        SetTextColor @lpdis.hDC, GetSysColor(%COLOR_HIGHLIGHTTEXT)  ' Text color
                    END IF

                    ' Get/Draw current item's text
                    CONTROL SEND CBHNDL, %IDC_HOTKEYLIST, %LB_GETTEXT, @lpdis.itemID, VARPTR(szTxt)
                    CALL DrawText(@lpdis.hDC, szTxt, LEN(szTxt), @lpdis.rcItem, %DT_SINGLELINE OR %DT_LEFT OR %DT_VCENTER)

                    'Draw grid lines
                    hPen = CreatePen(%PS_SOLID, 1, %WHITE)'GetSysColor(%white))'%COLOR_3DFACE))
                    hPen = SelectObject(@lpdis.hDC, hPen)
                    MoveToEx @lpdis.hDC, 0, @lpdis.rcItem.nBottom - 1, BYVAL %NULL
                    LineTo @lpdis.hDC, @lpdis.rcItem.nRight, @lpdis.rcItem.nBottom - 1
                    DeleteObject SelectObject(@lpdis.hDC, hPen)

                    FUNCTION = %TRUE
                    EXIT FUNCTION
            END SELECT
        END IF
  END SELECT

END FUNCTION
FUNCTION SetLanguage(BYVAL lang AS STRING)AS LONG
  LOCAL hDB AS LONG
  LOCAL errStr AS STRING
  LOCAL sSql AS STRING
  LOCAL tmpStr AS STRING
  LOCAL rs() AS STRING
  REDIM rs()
  IF lang="" THEN
    FUNCTION=0
    EXIT FUNCTION
  END IF
  IF language="" THEN
    language="English"
  END IF
  '根据选择的语言，查数据库，得到该语言对应的内部表示名称
  IF Exist($DATABASENAME)=0 THEN '如果数据库文件不存在，则创建数据库
    IF MakeDB($DATABASENAME)=0 THEN
      MSGBOX "数据异常 SetLanguage"
      FUNCTION=0
      EXIT FUNCTION
    ELSE
      InitConfig
    END IF
  END IF
  errStr=""
  IF ISTRUE sqlOpen($DATABASENAME,hDB) THEN
    errStr="无法打开或创建数据库,"
    GOTO abort
  END IF
  sSql="select name from "+$STRINGLANGTABLENAME+" where "+language+"='"+lang+"'"
  IF sqlQuery(hDB,sSql,rs())<0 THEN
    errStr="数据库错误，查询" & $STRINGLANGTABLENAME & ","
    GOTO abort
  END IF
  tmpStr=""
  IF UBOUND(rs)<=0 THEN
    errStr="ResultSet error"
    GOTO abort
  END IF
  tmpStr=rs(1,0)
  sqlClose hDB
  IF tmpStr<>"" THEN
    language=tmpStr
  ELSE
    FUNCTION=0
    EXIT FUNCTION
  END IF
  WriteConfig "language",language
  '查数据库完成
  SetOptionLang
  SetMenuLang
  EXIT FUNCTION
abort:
  sqlClose hDB
  MSGBOX errStr
  FUNCTION=0
END FUNCTION
'对选项对话框设置语言
FUNCTION SetOptionLang() AS LONG
  LOCAL tmpStr AS STRING
  LOCAL lang() AS STRING
  LOCAL i AS INTEGER
  language=ReadConfig("language")
  IF language="" THEN
    language="English"
  END IF
  tmpStr=ReadDataset("language") '从数据集中取出定义的所有语言
  IF tmpStr<>"" THEN
    REDIM lang(1 TO PARSECOUNT(tmpStr,"|"))  '对定义的所有语言进行分解并赋给全局lang()变量
    PARSE tmpStr,lang(),"|"
    COMBOBOX RESET htabDlg(0),%IDC_SETLANGUAGE
    FOR i=1 TO UBOUND(lang())              '循环读取lang()中的值
      tmpStr=ReadLang(lang(i),language)
      IF tmpStr<>"" THEN                   '如果不为空，则
        COMBOBOX INSERT htabDlg(0),%IDC_SETLANGUAGE, i,tmpStr '插入到界面上的语言列表中
        IF lang(i)=language THEN                              '如果当前选择的语言与语言列表中的某一项相等，则界面上设置为选择状态
          COMBOBOX SELECT htabDlg(0),%IDC_SETLANGUAGE,i
        END IF
      END IF
    NEXT i
  END IF
  tmpStr=GetLang("Option")
  DIALOG SET TEXT g_hOptionWin, tmpStr
  '主项列表
  LISTBOX RESET g_hOptionWin, %IDC_MAINLISTBOX
  tmpStr=GetLang("General")
  LISTBOX ADD g_hOptionWin,%IDC_MAINLISTBOX,tmpStr
  CONTROL SET TEXT htabDlg(0),%IDC_LABELPAGESIGN,tmpStr
  tmpStr=GetLang("File")
  LISTBOX ADD g_hOptionWin,%IDC_MAINLISTBOX,tmpStr
  CONTROL SET TEXT htabDlg(1),%IDC_LABELPAGESIGN,tmpStr
  tmpStr=GetLang("Code Editor")
  LISTBOX ADD g_hOptionWin,%IDC_MAINLISTBOX,tmpStr
  CONTROL SET TEXT htabDlg(2),%IDC_LABELPAGESIGN,tmpStr
  tmpStr=GetLang("Color")
  LISTBOX ADD g_hOptionWin,%IDC_MAINLISTBOX,tmpStr
  CONTROL SET TEXT htabDlg(3),%IDC_LABELPAGESIGN,tmpStr
  tmpStr=GetLang("Window Editor")
  LISTBOX ADD g_hOptionWin,%IDC_MAINLISTBOX,tmpStr
  CONTROL SET TEXT htabDlg(4),%IDC_LABELPAGESIGN,tmpStr
  tmpStr=GetLang("Compile")
  LISTBOX ADD g_hOptionWin,%IDC_MAINLISTBOX,tmpStr
  CONTROL SET TEXT htabDlg(5),%IDC_LABELPAGESIGN,tmpStr
  tmpStr=GetLang("Print")
  LISTBOX ADD g_hOptionWin,%IDC_MAINLISTBOX,tmpStr
  CONTROL SET TEXT htabDlg(6),%IDC_LABELPAGESIGN,tmpStr
  tmpStr=GetLang("Hotkey")
  LISTBOX ADD g_hOptionWin,%IDC_MAINLISTBOX,tmpStr
  CONTROL SET TEXT htabDlg(7),%IDC_LABELPAGESIGN,tmpStr
  LISTBOX SELECT g_hOptionWin,%IDC_MAINLISTBOX,1
  '确定按钮
  SetControlLang "OK", g_hOptionWin,%IDOK
  '取消按钮
  SetControlLang "Cancel" ,g_hOptionWin,%IDCANCEL
  '应用按钮
  SetControlLang "Apply",g_hOptionWin,%IDC_APPLYBUT
  '帮助按钮
  SetControlLang "Help",g_hOptionWin,%IDC_HELPBUT
  '默认按钮
  SetControlLang "Default",g_hOptionWin,%IDC_DEFAULTBUT
  '常规
  SetControlLang "Show welcome window when startup",htabDlg(0),%IDC_SHOWWELCOME
  SetControlLang "Show guilder window after startup",htabDlg(0),%IDC_SHOWGUILD
  SetControlLang "Main window pos && size",htabDlg(0),%IDC_MAINWINDOWPOS
  SetControlLang "Use default position and size",htabDlg(0),%IDC_DEFAULTPOSSIZE
  SetControlLang "Use fix position and size",htabDlg(0),%IDC_FIXPOSSIZE
  SetControlLang "Use the position and size for last",htabDlg(0),%IDC_USELASTPOSSIZE
  SetControlLang "Position" ,htabDlg(0),%IDC_POSITION
  SetControlLang "Center" ,htabDlg(0),%IDC_SETCENTER
  SetControlLang "Special",htabDlg(0),%IDC_SETPOSITION
  SetControlLang "Size" ,htabDlg(0),%IDC_MAINWINDOWSIZE
  SetControlLang "Width:",htabDlg(0),%IDC_LABELWIDTH
  SetControlLang "Height:",htabDlg(0),%IDC_LABELHEIGHT
  SetControlLang "Please select language for this application:",htabDlg(0),%IDC_LANGUAGE
  '文件
  SetControlLang "Type" ,htabDlg(1),%IDC_FILETYPE
  SetControlLang "PB Source File:",htabDlg(1),%IDC_LABELSOURCEFILE
  SetControlLang "PB Head File:",htabDlg(1),%IDC_LABELINCLUDEFILE
  SetControlLang "RC File:",htabDlg(1),%IDC_LABELRCFILE
  SetControlLang "RC Head File:" ,htabDlg(1),%IDC_LABELRCHEADFILE
  SetControlLang "PB Project File:" ,htabDlg(1),%IDC_LABELPROJECTFILE
  SetControlLang "Register these file extend in windows",htabDlg(1),%IDC_SETFILEEXT
  SetControlLang "Reload previous file set at startup",htabDlg(1),%IDC_LOADRECENTFILES
  SetControlLang "Maximum Recent Files:",htabDlg(1),%IDC_LABELMAXFILE
  SetControlLang "Initial startup folder",htabDlg(1),%IDC_STARTUPFOLDER
  SetControlLang "Start in Default folder",htabDlg(1),%IDC_DEFAULTFOLDER
  SetControlLang "Start in Last folder",htabDlg(1),%IDC_LASTFOLDER
  '代码编辑器
  SetControlLang "Auto indent",htabDlg(2),%IDC_AUTOINDENT
  setControlLang "Keep Undo after save",htabDlg(2),%IDC_KEEPUNDO
  SetControlLang "Tab size:", htabDlg(2),%IDC_LABELTABSIZE
  SetControlLang "Auto save when",htabDlg(2),%IDC_AUTOSAVE1
  SetControlLang "minutes",htabDlg(2),%IDC_AUTOSAVE2
  SetControlLang "Show line number",htabDlg(2),%IDC_SHOWLINENUMBER
  SetControlLang "Show auto complete tip",htabDlg(2),%IDC_SHOWAUTOCOMPLETE
  SetControlLang "Keyword Case",htabDlg(2),%IDC_KEYWORDCASE
  SetControlLang "No Case Change",htabDlg(2),%IDC_NOCASECHANGE
  SetControlLang "Upper Case",htabDlg(2),%IDC_UPPERCASE
  SetControlLang "Mixed Case",htabDlg(2),%IDC_MIXEDCASE
  SetControlLang "Lower Case",htabDlg(2),%IDC_LOWERCASE
  SetControlLang "Editor Font",htabDlg(2),%IDC_EDITORFONT
  SetControlLang "Font:",htabDlg(2),%IDC_LABELFONT
  SetControlLang "Size:",htabDlg(2),%IDC_LABELFONTSIZE
  SetControlLang "Sample text",htabDlg(2),%IDC_LABELSAMPLETEXT
  SetControlLang "Collapse && Expand",htabDlg(2),%IDC_COLLAPSEEXPAND
  SetControlLang "Foldding Level",htabDlg(2),%IDC_COLLAPSELEVEL
  SetControlLang "No Collapse",htabDlg(2),%IDC_NOCOLLAPSE
  SetControlLang "Keyword level",htabDlg(2),%IDC_KEYWORDLEVEL
  SetControlLang "Sub/Function level",htabDlg(2),%IDC_SUBFUNLEVEL
  SetControlLang "Folder icon",htabDlg(2),%IDC_FOLDERICON
  SetControlLang "Arrow",htabDlg(2),%IDC_ARROWICON
  SetControlLang "Circle",htabDlg(2),%IDC_CIRCLEICON
  SetControlLang "Square",htabDlg(2),%IDC_SQUAREICON
  '颜色
  SetControlLang "Use Syntax Color in Editor",htabDlg(3),%IDC_USECOLORINEDITOR
  SetControlLang "Use Syntax Color when Print",htabDlg(3),%IDC_USECOLORINPRINTER
  SetControlLang "Load &Defaults",htabDlg(3),%IDC_LOADDEFAULTCOLOR
  SetControlLang "Assembler",htabDlg(3),%IDC_ASSEMBLERBUTTON
  SetControlLang "Comments",htabDlg(3),%IDC_COMMENTBUTTON
  SetControlLang "Keywords",htabDlg(3),%IDC_KEYWORDBUTTON
  SetControlLang "PB Forms",htabDlg(3),%IDC_PBFORMSBUTTON
  SetControlLang "Strings",htabDlg(3),%IDC_STRINGBUTTON
  SetControlLang "Text",htabDlg(3),%IDC_TEXTBUTTON
  SetControlLang "Selection",htabDlg(3),%IDC_SELECTIONBUTTON
  SetControlLang "Breakpoint",htabDlg(3),%IDC_BREAKPOINTBUTTON
  SetControlLang "Bookmark",htabDlg(3),%IDC_BOOKMARKBUTTON
  SetControlLang "Exec point",htabDlg(3),%IDC_EXECPOINTBUTTON
  SetControlLang "Reserved",htabDlg(3),%IDC_RESERVED1BUTTON
  SetControlLang "Reserved",htabDlg(3),%IDC_RESERVED2BUTTON
  '窗体编辑器
  SetControlLang "Show grid",htabDlg(4),%IDC_SHOWGRID
  SetControlLang "Snap to grid",htabDlg(4),%IDC_GRIDSNAP
  SetControlLang "Grid size:",htabDlg(4),%IDC_LABELGRIDSIZE
  SetControlLang "Snap between controls",htabDlg(4),%IDC_SNAPCONTROL
  SetControlLang "Adjust handle size",htabDlg(4),%IDC_ADJUSTHANDLE
  SetControlLang "Small",htabDlg(4),%IDC_SMALLHANDLE
  SetControlLang "Medium",htabDlg(4),%IDC_MEDIUMHANDLE
  SetControlLang "Large",htabDlg(4),%IDC_LARGEHANDLE
  '编译
  SetControlLang "Paths",htabDlg(5),%IDC_PATH
  SetControlLang "PB Include:",htabDlg(5),%IDC_LABELPBINCLUDE
  SetControlLang "RC Include:",htabDlg(5),%IDC_LABELRCINCLUDE
  SetControlLang "Compiler File:",htabDlg(5),%IDC_LABELCOMPILER
  SetControlLang "Win32.hlp File:",htabDlg(5),%IDC_LABELWIN32HELP
  SetControlLang "Compiler Options",htabDlg(5),%IDC_COMPILEOPTION
  SetControlLang "Beep on compiletion",htabDlg(5),%IDC_BEEPCOMPLETION
  SetControlLang "Display Results",htabDlg(5),%IDC_DISPLAYRESULT
  SetControlLang "Create Log file",htabDlg(5),%IDC_CREATELOGFILE
  '打印
  SetControlLang "Use the color for code in editor when print",htabDlg(6),%IDC_USECODECOLOR
  SetControlLang "Print page number on footer with the format [#/#]",htabDlg(6),%IDC_PRINTPAGENUMBER
  SetControlLang "Print filename, time and date of the file on header",htabDlg(6),%IDC_PRINTFILENAMETIME
  SetControlLang "Margin",htabDlg(6),%IDC_PAGEMARGIN
  SetControlLang "Top:",htabDlg(6),%IDC_LABELTOPMARGIN
  SetControlLang "Bottom:",htabDlg(6),%IDC_LABELBOTTOMMARGIN
  SetControlLang "Left:",htabDlg(6),%IDC_LABELLEFTMARGIN
  SetControlLang "Right:",htabDlg(6),%IDC_LABELRIGHTMARGIN
  '热键
  SetControlLang "Defined Hotkey:",htabDlg(7),%IDC_LABELHADHOTKEY
  SetControlLang "Delete",htabDlg(7),%IDC_DELETEHOTKEY
  SetControlLang "Command:",htabDlg(7),%IDC_LABELHOTKEYCOMMAND
  SetControlLang "Hotkey:",htabDlg(7),%IDC_LABELHOTKEY
  SetControlLang "Update",htabDlg(7),%IDC_UPDATEHOTKEY
END FUNCTION
'给特定窗口的特定控件设置语言
FUNCTION SetControlLang(BYVAL OriStr AS STRING,BYVAL hWnd AS DWORD,BYVAL CtrlID AS DWORD)AS LONG
  LOCAL tmpStr AS STRING
  tmpStr=GetLang(OriStr)
  CONTROL SET TEXT hWnd,CtrlID,tmpStr
  IF tmpStr=OriStr THEN
    FUNCTION=0
  ELSE
    FUNCTION=1
  END IF
END FUNCTION
'对所有菜单设置语言
FUNCTION SetMenuLang()AS LONG
  LOCAL tmpStr AS STRING
  LOCAL tmphWnd AS DWORD
  LOCAL i AS INTEGER
  i=1
  IF MdiGetActive(g_hWndClient) AND _      '如果不是第一份文档且文档是最大化的，则切换菜单，并重绘
     IsZoomed(MdiGetActive(g_hWndClient)) THEN
    i=i+1
  END IF
  tmpStr=GetLang("File")
  MENU SET TEXT g_hMenu,i,tmpStr
  INCR i
  tmpStr=GetLang("Edit")
  MENU SET TEXT g_hMenu,i,tmpStr
  INCR i
  tmpStr=GetLang("Run")
  MENU SET TEXT g_hMenu,i,tmpStr
  INCR i
  tmpStr=GetLang("View")
  MENU SET TEXT g_hMenu,i,tmpStr
  INCR i
  tmpStr=GetLang("Tool")
  MENU SET TEXT g_hMenu,i,tmpStr
  INCR i
  tmpStr=GetLang("Project")
  MENU SET TEXT g_hMenu,i,tmpStr
  INCR i
  tmpStr=GetLang("Cooperation")
  MENU SET TEXT g_hMenu,i,tmpStr
  INCR i
  tmpStr=GetLang("Window")
  MENU SET TEXT g_hMenu,i,tmpStr
  INCR i
  tmpStr=GetLang("Help")
  MENU SET TEXT g_hMenu,i,tmpStr
'g_hMenuFile g_hMenuEdit g_hMenuRun g_hMenuView g_hMenuTool
' g_hMenuProject g_hMenuCoop g_hMenuWindow g_hMenuHelp
  tmpStr=GetLang("New")
  MENU SET TEXT g_hMenuFile,1,tmpStr
  SetMenuItemLang "New Project", g_hMenuFile, %IDM_NEWPROJECT
  SetMenuItemLang "New BAS File", g_hMenuFile, %IDM_NEWBAS
  SetMenuItemLang "Open", g_hMenuFile, %IDM_OPEN
  tmpStr=GetLang("Reopen...")
  MENU SET TEXT g_hMenuFile,3,tmpStr
  SetMenuItemLang "Open Project",g_hMenuFile,%IDM_OPENPROJECT
  SetMenuItemLang "Save",g_hMenuFile,%IDM_SAVE
  SetMenuItemLang "Save As",g_hMenuFile,%IDM_SAVEAS
  SetMenuItemLang "Save All",g_hMenuFile,%IDM_SAVEALL
  SetMenuItemLang "Save Project",g_hMenuFile,%IDM_SAVEPROJECT
  SetMenuItemLang "Print Setting",g_hMenuFile,%IDM_PRINTSETTING
  SetMenuItemLang "Print Preview",g_hMenuFile,%IDM_PRINTPREVIEW
  SetMenuItemLang "Print...",g_hMenuFile,%IDM_PRINT
  SetMenuItemLang "Close",g_hMenuFile,%IDM_CLOSE
  SetMenuItemLang "Close All",g_hMenuFile,%IDM_CLOSEALL
  SetMenuItemLang "Open Command",g_hMenuFile,%IDM_OPENCMD
  SetMenuItemLang "Exit",g_hMenuFile,%IDM_EXIT
  'g_hMenuEdit
  SetMenuItemLang "Undo",g_hMenuEdit,%IDM_UNDO
  SetMenuItemLang "Cut",g_hMenuEdit,%IDM_CUT
  SetMenuItemLang "Copy",g_hMenuEdit,%IDM_COPY
  SetMenuItemLang "Paste",g_hMenuEdit,%IDM_PASTE
  SetMenuItemLang "Delete",g_hMenuEdit,%IDM_DELETE
  SetMenuItemLang "Select all",g_hMenuEdit,%IDM_SELALL
  tmpStr=GetLang("Block")
  MENU SET TEXT g_hMenuEdit,9,tmpStr
  tmphWnd=GetSubMenu(g_hMenuEdit,8)
  SetMenuItemLang "Comment",tmphWnd,%IDM_COMMENT
  SetMenuItemLang "UnComment",tmphWnd,%IDM_UNCOMMENT
  SetMenuItemLang "Indent",tmphWnd,%IDM_INDENT
  SetMenuItemLang "Outdent",tmphWnd,%IDM_OUTDENT
'  SetMenuItemLang "Space Indent",tmphWnd,%IDM_SPACEINDENT
'  SetMenuItemLang "Space Outdent",tmphWnd,%IDM_SPACEOUTDENT
  SetMenuItemLang "Insert GUID",g_hMenuEdit,%IDM_GUID
  SetMenuItemLang "Find...",g_hMenuEdit,%IDM_FIND
  SetMenuItemLang "Find Next",g_hMenuEdit,%IDM_FINDNEXT
  SetMenuItemLang "Replace...",g_hMenuEdit,%IDM_REPLACE
  SetMenuItemLang "Goto Line...",g_hMenuEdit,%IDM_GOTOLINE
  'SetMenuItemLang "Goto Bookmark...",g_hMenuEdit,%IDM_GOTOBOOKMARK
  'g_hMenuRun
  SetMenuItemLang "Compile",g_hMenuRun,%IDM_COMPILE
  SetMenuItemLang "Compile and Run",g_hMenuRun,%IDM_COMPILERUN
  SetMenuItemLang "Run",g_hMenuRun,%IDM_EXECUTE
  SetMenuItemLang "Set Primary File",g_hMenuRun,%IDM_SETPRIMARY
  SetMenuItemLang "Set Command Parameter",g_hMenuRun,%IDM_cmdparameter
  'g_hMenuView
  SetMenuItemLang "Control ToolBox",g_hMenuView,%IDM_CONTROLS 'BOX
  SetMenuItemLang "Project ToolBox",g_hMenuView,%IDM_PROJECT 'BOX
  SetMenuItemLang "Property ToolBox",g_hMenuView,%IDM_PROPERTY 'BOX
  SetMenuItemLang "Find Result Window",g_hMenuView,%IDM_FINDRS 'BOX
  SetMenuItemLang "Compile Info Window",g_hMenuView,%IDM_COMPILERS 'INFOBOX
  tmpStr=GetLang("ToolBar")
  MENU SET TEXT g_hMenuView,6,tmpStr
  'g_hMenuTool
  SetMenuItemLang "Make Menu",g_hMenuTool,%IDM_MAKEMENU
  SetMenuItemLang "Make Toolbar",g_hMenuTool,%IDM_MAKETOOLBAR
  SetMenuItemLang "Find Multi Dir",g_hMenuTool,%IDM_FINDMULTIDIR
  SetMenuItemLang "Replace Multi Dir",g_hMenuTool,%IDM_REPLACEMULTIDIR
  SetMenuItemLang "Format code",g_hMenuTool,%IDM_FORMATCODE
  SetMenuItemLang "WinSpy",g_hMenuTool,%IDM_WINSPY
  SetMenuItemLang "Code Counter",g_hMenuTool,%IDM_CODECOUNT
  SetMenuItemLang "Code Manager",g_hMenuTool,%IDM_CODEMANAGER
  SetMenuItemLang "Custom Tool Setting",g_hMenuTool,%IDM_CUSTOMTOOLSETTING
  'g_hMenuProject
  SetMenuItemLang "New Project...",g_hMenuProject,%IDM_NEWPROJECT
  SetMenuItemLang "Save Project",g_hMenuProject,%IDM_SAVEPROJECT
  SetMenuItemLang "Save as Project...",g_hMenuProject,%IDM_SAVEPROJECTAS
  SetMenuItemLang "Achive...",g_hMenuProject,%IDM_ACHIVE
  SetMenuItemLang "New Vision",g_hMenuProject,%IDM_NEWVISION
  SetMenuItemLang "Set Vision for files",g_hMenuProject,%IDM_FILEVISIONSETTING
  SetMenuItemLang "Package Vision...",g_hMenuProject,%IDM_VISIONPACKAGE
  'g_hMenuCoop
  SetMenuItemLang "Coop Setting...",g_hMenuCoop,%IDM_COOPSETTING
  SetMenuItemLang "Send Invite",g_hMenuCoop,%IDM_SENDINVITE
  SetMenuItemLang "Send Visit",g_hMenuCoop,%IDM_SENDVISIT
  SetMenuItemLang "Download Files",g_hMenuCoop,%IDM_DOWNLOADFILE
  SetMenuItemLang "Upload Files",g_hMenuCoop,%IDM_UPLOADFILE
  SetMenuItemLang "Chat...",g_hMenuCoop,%IDM_CHAT
  'g_hMenuWindow
  SetMenuItemLang "Cascade",g_hMenuWindow,%IDM_CASCADE
  SetMenuItemLang "Tile horizontally",g_hMenuWindow,%IDM_TILEH
  SetMenuItemLang "Tile vertically",g_hMenuWindow,%IDM_TILEV
  SetMenuItemLang "Arrange Icons",g_hMenuWindow,%IDM_ARRANGE
  SetMenuItemLang "Close All",g_hMenuWindow,%IDM_CLOSE
  SetMenuItemLang "Maximize Window",g_hMenuWindow,%IDM_MAXWIN
  SetMenuItemLang "Switch to Window",g_hMenuWindow,%IDM_SWITCHWINDOW
  SetMenuItemLang "Option...",g_hMenuWindow,%IDM_OPTION
  'g_hMenuHelp
  SetMenuItemLang "IDE Help",g_hMenuHelp,%IDM_IDEHELP
  SetMenuItemLang "PB/WIN Content",g_hMenuHelp,%IDM_PBWINCONTENT
  SetMenuItemLang "PB/WIN Index",g_hMenuHelp,%IDM_PBWININDEX
  SetMenuItemLang "PB/WIN Search",g_hMenuHelp,%IDM_PBWINSEARCH
  SetMenuItemLang "Windows SDK Help",g_hMenuHelp,%IDM_WINDOWSSDK
  SetMenuItemLang "About",g_hMenuHelp,%IDM_ABOUT
  SetMenuItemLang "Update",g_hMenuHelp,%IDM_UPDATE
END FUNCTION
'设置菜单项的语言
FUNCTION SetMenuItemLang(BYVAL OriStr AS STRING,BYVAL hMenu AS DWORD,BYVAL MenuItemID AS DWORD) AS LONG
  LOCAL tmpStr AS STRING
  LOCAL tmpStr1 AS STRING
  tmpStr=GetLang(OriStr)
  tmpStr1=ReadConfig(OriStr)
  IF tmpStr1<>"" THEN
    REPLACE " " WITH "" IN tmpStr1
  END IF
  IF tmpStr1<>"" THEN
    tmpStr=tmpStr & $TAB & tmpStr1
  END IF
  MENU SET TEXT hMenu,BYCMD MenuItemID,tmpStr
  IF tmpStr=OriStr THEN
    FUNCTION=0
  ELSE
    FUNCTION=1
  END IF
END FUNCTION
'注册文件类型关联打开到本程序，或取消注册
FUNCTION RegistryFileType(BYVAL Value AS LONG)AS LONG

END FUNCTION
'加载默认颜色
FUNCTION LoadDefaultColor(BYVAL hDlg AS DWORD)AS LONG
  LOCAL tmpStr AS STRING
  LOCAL tmpStr1 AS STRING
  IF hDlg<=0 THEN
    FUNCTION=0
    EXIT FUNCTION
  END IF
  tmpStr=ReadDefaultConfig("assembleforecolor")
  tmpStr1=ReadDefaultConfig("assemblebackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELASM,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("commentforecolor")
  tmpStr1=ReadDefaultConfig("commentbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELREM,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("assembleforecolor")
  tmpStr1=ReadDefaultConfig("assemblebackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELASM,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("keywordforecolor")
  tmpStr1=ReadDefaultConfig("keywordbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELTCPOPEN,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("pbformforecolor")
  tmpStr1=ReadDefaultConfig("pbformbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELPBFORMS,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("stringforecolor")
  tmpStr1=ReadDefaultConfig("stringbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELLITERAL,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("textforecolor")
  tmpStr1=ReadDefaultConfig("textbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELTEXT,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("selectedforecolor")
  tmpStr1=ReadDefaultConfig("selectedbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELMARKED,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("breakpointforecolor")
  tmpStr1=ReadDefaultConfig("breakpointbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELBREAKPOINT,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("bookmarkforecolor")
  tmpStr1=ReadDefaultConfig("bookmarkbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELBOOKMARK,GetColor(tmpStr),GetColor(tmpStr1)
  tmpStr=ReadDefaultConfig("execpointforecolor")
  tmpStr1=ReadDefaultConfig("execpointbackcolor")
  CONTROL SET COLOR htabDlg(3),%IDC_LABELEXECPOINT,GetColor(tmpStr),GetColor(tmpStr1)
END FUNCTION
' *********************************************************************************************
' Writes the Printer Setup options to the .INI file
' *********************************************************************************************
SUB WritePrinterSetupOptions (PrnOpt AS PrinterSetupOptionsType)
   IniWrite g_zIni, "Printer options", "PaperSize", FORMAT$(PrnOpt.PaperSize)
   IniWrite g_zIni, "Printer options", "PaperBin", FORMAT$(PrnOpt.PaperBin)
   IniWrite g_zIni, "Printer options", "Orientation", FORMAT$(PrnOpt.Orientation)
   IniWrite g_zIni, "Printer options", "FontName", PrnOpt.FontName
   IniWrite g_zIni, "Printer options", "FontSize", FORMAT$(PrnOpt.FontSize)
   IniWrite g_zIni, "Printer options", "FontBold", FORMAT$(PrnOpt.FontBold)
   IniWrite g_zIni, "Printer options", "FontItalic", FORMAT$(PrnOpt.FontItalic)
   IniWrite g_zIni, "Printer options", "FontUnderline", FORMAT$(PrnOpt.FontUnderline)
   IniWrite g_zIni, "Printer options", "MarginLeft", FORMAT$(PrnOpt.MarginLeft)
   IniWrite g_zIni, "Printer options", "MarginRight", FORMAT$(PrnOpt.MarginRight)
   IniWrite g_zIni, "Printer options", "MarginTop", FORMAT$(PrnOpt.MarginTop)
   IniWrite g_zIni, "Printer options", "MarginBottom", FORMAT$(PrnOpt.MarginBottom)
   IniWrite g_zIni, "Printer options", "LineHeight", FORMAT$(PrnOpt.LineHeight)
END SUB
